YUI.add("flickr-contacts-block-updater",(function(c,r){"use strict";c.namespace("ModelUpdaters")["flickr-contacts-block"]={run:function(t,e){return e.callAPI("flickr.contacts.block",t).then(null,c.FetcherErrorLogger(r))}}}),"@VERSION@",{requires:["flickr-promise"]});YUI.add("flickr-contacts-unblock-updater",(function(c,r){"use strict";c.namespace("ModelUpdaters")["flickr-contacts-unblock"]={run:function(n,t){return t.callAPI("flickr.contacts.unblock",n).then(null,c.FetcherErrorLogger(r))}}}),"@VERSION@",{requires:["flickr-promise"]});YUI.add("attribute-helpers",(function(n){function e(n){if(null==n)return!0}n.AttributeHelpers={validateString:function(t){return!!e(t)||(!!n.Lang.isString(t)||!!n.Lang.isNumber(t))},coerceString:function(e){return n.Lang.isNumber(e)&&(e=e.toString()),n.Lang.isString(e)?e:void 0},validateInteger:function(t){return!!e(t)||(n.Lang.isString(t)&&(t=parseInt(t,10)),!!n.Lang.isNumber(t))},coerceInteger:function(e){return n.Lang.isString(e)&&(e=parseInt(e,10)),n.Lang.isNumber(e)?e<0?Math.ceil(e):Math.floor(e):void 0},validateFloat:function(t){return!!e(t)||(n.Lang.isString(t)&&(t=parseFloat(t)),!!n.Lang.isNumber(t))},coerceFloat:function(e){if(n.Lang.isString(e)&&(e=parseFloat(e)),n.Lang.isNumber(e))return e},validateBoolean:function(t){return!!e(t)||(!!n.Lang.isBoolean(t)||([0,"0","false"].indexOf(t)>-1||[1,"1","true"].indexOf(t)>-1))},coerceBoolean:function(n){return!([!1,"0",0,"false"].indexOf(n)>-1)&&([!0,"1",1,"true"].indexOf(n)>-1||void 0)},validateDate:function(t){return!!e(t)||-1===[!0,!1].indexOf(t)&&(!(t instanceof Array)&&("string"==typeof t&&(t=parseInt(t,10)),"object"==typeof t&&void 0!==t._d&&(t=t._d),!!n.moment(t).isValid()))},coerceDate:function(e){var t=null,i=null;return n.moment.isMoment(e)?e:e&&"object"==typeof e&&e._d&&((i=n.moment(e)).isValid()||(i=n.moment(e._d)),i.isValid())?i:"number"==typeof e||e===parseInt(e,10).toString()?i=(t=parseInt(e,10)).toString().length<=10?n.moment(t.toString(),"X"):n.moment(t):e&&!n.Lang.isBoolean(e)&&(n.moment(new Date(e)).isValid()||n.moment(new Date(e.toString().replace(" ","T"))).isValid())?n.moment(e):void 0}}}),"@VERSION@",{requires:["moment"]});YUI.add("flickr-account-settings-permission-fetcher",(function(e,r){"use strict";e.namespace("ModelFetchers")["flickr-account-settings-permission"]={run:function(i,s){var t=this,a=["default_hidden","prefs_default_license","prefs_default_family","prefs_default_public","prefs_default_friend","prefs_can_see_me_in_photos","prefs_default_comment","prefs_default_addmeta","prefs_isset_viewgeo","prefs_default_viewgeo","prefs_import_geoexif","default_content_type","safe_search","content_type_search","no_video_search","privacy_photos_hide_exif","privacy_profile_hide","perms_galleries","prefs_can_add_me_to_photos","prefs_api_optout","sharing_ok","privacy_photos_download","privacy_profile_email","privacy_profile_name","privacy_profile_location","photo_display_size","default_safety_level","privacy_photos_print"].join(",");return e.Promise.all([s.getModelRegistry("account-settings-models"),s.callAPI("flickr.prefs.getPrefs",{extras:a}),s.callAPI("flickr.profile.getProfile",{user_id:i.user_id}),s.callAPI("flickr.geofences.getList",{user_id:i.user_id})]).then((function(e){return t._processResponse(e,i)}),e.FetcherErrorLogger(r))},_processResponse:function(e,r){var i=e[0],s=e[1].settingsPrefs,t=e[2].profile,a=e[3],o={defaultUploads:{prefsDefaultPublic:s.prefsDefaultPublic,prefsDefaultFamily:s.prefsDefaultFamily,prefsDefaultFriend:s.prefsDefaultFriend,prefsDefaultComment:s.prefsDefaultComment,prefsDefaultAddmeta:s.prefsDefaultAddmeta,prefsDefaultLicense:s.prefsDefaultLicense,prefsIssetViewgeo:s.prefsIssetViewgeo,prefsDefaultViewgeo:s.prefsDefaultViewgeo,geofences:a.geofences,prefsImportGeoexif:s.prefsImportGeoexif,defaultSafetyLevel:s.defaultSafetyLevel,defaultContentType:s.defaultContentType,privacyPhotosPrint:s.privacyPhotosPrint},contentFilters:{safeSearch:s.safeSearch,contentTypeSearch:s.contentTypeSearch,noVideoSearch:s.noVideoSearch},globalSettings:{privacyPhotosHideExif:s.privacyPhotosHideExif,privacyProfileHide:s.privacyProfileHide,permsGalleries:s.permsGalleries,prefsCanAddMeToPhotos:s.prefsCanAddMeToPhotos,prefsApiOptout:s.prefsApiOptout,defaultHidden:s.defaultHidden,sharingOk:s.sharingOk,privacyPhotosDownload:s.privacyPhotosDownload,privacyProfileEmail:s.privacyProfileEmail,privacyProfileName:s.privacyProfileName,privacyProfileLocation:s.privacyProfileLocation,photoDisplaySize:s.photoDisplaySize,userFirstName:t.firstName,userLastName:t.lastName,userEmail:t.email,userCity:t.city}};return i.add({id:r.user_id,permissions:o}),i.proxy(r.user_id)}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["account-settings-models"]});YUI.add("account-settings-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-account-settings-permission"].run(t,this.appContext)}},attributes:{id:{},permissions:{}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-account-settings-permission-fetcher"]});YUI.add("flickr-prefs-setSafeSearch-updater",(function(e,s){"use strict";e.namespace("ModelUpdaters")["flickr-prefs-setSafeSearch"]={run:function(r,t){return e.Promise.all([t.callAPI("flickr.prefs.setSafeSearch",r),t.getModelRegistry("account-settings-models")]).then((e=>this._processResponse(e,r,t)),e.FetcherErrorLogger(s))},_processResponse:function(e,s,r){e[0];var t=e[1],a={1:"on",2:"moderate",3:"off"}[s.safe_search];return t.get(r.getViewer().nsid).then((e=>{var s=e.getValue("permissions"),r=Object.assign({},s);r.contentFilters.safeSearch=a,e.setValue("permissions",r)}))}}}),"@VERSION@",{requires:["flickr-promise"],optional:["account-settings-models"]});YUI.add("person-preferences-models",(function(e){let t;function r(e){r.superclass.constructor.call(this,e),t=e}r.UNIFIED_SEARCH_VIEW_TYPES={justified:"jst",thumbs:"thm",tiles:"til"},r.UNIFIED_SEARCH_VIEW_TYPE_DEFAULT=r.UNIFIED_SEARCH_VIEW_TYPES.justified,r.PHOTOSTREAM_VIEW_ORDER_TYPES={dateposted:"dc",datetaken:"dt"},r.PHOTOSTREAM_VIEW_ORDER_DEFAULT=r.PHOTOSTREAM_VIEW_ORDER_TYPES.dateposted,r.PHOTOSTREAM_VIEW_AS_TYPES={me:"me",friend:"fr",family:"fa",ff:"ff",public:"pu"},r.PHOTOSTREAM_VIEW_PREF_MAP={me:"me",fr:"friend",fa:"family",ff:"ff",pu:"public",dc:"dateposted",dt:"datetaken"},r.ALBUM_VIEW_LAYOUT_TYPES={justified:"justified",story:"story"},r.NEW_ALBUM_VIEW_LAYOUT_TYPES={0:"standard",1:"large",2:"justified"},r.GALLERY_VIEW_LAYOUT_TYPES={large:"lv",justified:"jv",thumbnail:"tv"},r.PHOTOSTREAM_VIEW_LAYOUT_TYPES={card:"card",justified:"justified"},r.ALBUM_VIEW_LAYOUT_DEFAULT=r.ALBUM_VIEW_LAYOUT_TYPES.story,r.GALLERY_VIEW_LAYOUT_DEFAULT=r.GALLERY_VIEW_LAYOUT_TYPES.large,r.PHOTOSTREAM_VIEW_AS_DEFAULT=r.PHOTOSTREAM_VIEW_AS_TYPES.public,r.PHOTOSTREAM_VIEW_LAYOUT_DEFAULT=r.PHOTOSTREAM_VIEW_LAYOUT_TYPES.justified,e.Models[this.name]=r,e.extend(r,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(i,a){var n=[],s={};if(e.Lang.isObject(a,!0))if("safeSearch"in a)s.safe_search=e.AttributeHelpers.coerceInteger(a.safeSearch.newVal)+1,n.push(e.ModelUpdaters["flickr-prefs-setSafeSearch"].run(s,this.appContext));else if("photostreamViewOrderPref"in a||"photostreamViewAsPref"in a)a.photostreamViewOrderPref&&(s.photostream_view_order_pref=a.photostreamViewOrderPref.newVal),a.photostreamViewAsPref&&(s.photostream_view_as_pref=a.photostreamViewAsPref.newVal),n.push(this.appContext.callAPI("flickr.prefs.setPrefs",s));else if("albumViewLayoutPref"in a){if(a.albumViewLayoutPref)if(t.flipper.isFlipped("enable_new_album_layout")){for(const[e,t]of Object.entries(r.NEW_ALBUM_VIEW_LAYOUT_TYPES))if(t===a.albumViewLayoutPref.newVal){s.album_view_layout=e;break}}else s.album_view_layout=a.albumViewLayoutPref.newVal;n.push(this.appContext.callAPI("flickr.prefs.setPrefs",s))}else"galleryViewLayoutPref"in a?(a.galleryViewLayoutPref&&(s.galleries_view_layout_pref=a.galleryViewLayoutPref.newVal),n.push(this.appContext.callAPI("flickr.prefs.setPrefs",s))):"photostreamViewLayoutPref"in a?(a.photostreamViewLayoutPref&&(s.photostream_layout_type=a.photostreamViewLayoutPref.newVal),n.push(this.appContext.callAPI("flickr.prefs.setPrefs",s))):Object.keys(a).forEach((function(e){"unifiedSearchViewPref"===e?s.unified_search_view_pref=a.unifiedSearchViewPref.newVal:s[e]=a[e],n.push(this.appContext.callAPI("flickr.prefs.setPrefs",s))}));return e.Promise.all(n)},readUserPrefs:function(e,t){return t.callAPI("flickr.feed.preferences.getUserPreferences",e,t).then((function(e){return e}),(function(e){}))}},remoteReadUserPrefs:function(e,t,r){return this.remote.readUserPrefs(t,r).then((function(e){return e}),(function(e){}))},attributes:{safeSearch:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},unifiedSearchViewPref:{validator:function(t){return!!e.AttributeHelpers.validateString(t)&&Object.keys(r.UNIFIED_SEARCH_VIEW_TYPES).some((function(e){return r.UNIFIED_SEARCH_VIEW_TYPES[e]===t}))},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:r.UNIFIED_SEARCH_VIEW_TYPE_DEFAULT},photostreamViewOrderPref:{validator:function(t){return!!e.AttributeHelpers.validateString(t)&&Object.keys(r.PHOTOSTREAM_VIEW_ORDER_TYPES).some((function(e){return r.PHOTOSTREAM_VIEW_ORDER_TYPES[e]===t}))},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:r.PHOTOSTREAM_VIEW_ORDER_DEFAULT},photostreamViewAsPref:{validator:function(t){return!!e.AttributeHelpers.validateString(t)&&Object.keys(r.PHOTOSTREAM_VIEW_AS_TYPES).some((function(e){return r.PHOTOSTREAM_VIEW_AS_TYPES[e]===t}))},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:r.PHOTOSTREAM_VIEW_AS_DEFAULT},albumViewLayoutPref:{validator:function(i){return t.flipper.isFlipped("enable_new_album_layout")?e.AttributeHelpers.validateInteger(i)?i in r.NEW_ALBUM_VIEW_LAYOUT_TYPES:!!e.AttributeHelpers.validateString(i)&&Object.values(r.NEW_ALBUM_VIEW_LAYOUT_TYPES).includes(i):!!e.AttributeHelpers.validateString(i)&&Object.keys(r.ALBUM_VIEW_LAYOUT_TYPES).some((function(e){return r.ALBUM_VIEW_LAYOUT_TYPES[e]===i}))},setter:function(i){if(!t.flipper.isFlipped("enable_new_album_layout"))return e.AttributeHelpers.coerceString(i);if(e.AttributeHelpers.validateInteger(i))return e.AttributeHelpers.coerceString(r.NEW_ALBUM_VIEW_LAYOUT_TYPES[i]);if(e.AttributeHelpers.validateString(i))for(const[t,a]of Object.entries(r.NEW_ALBUM_VIEW_LAYOUT_TYPES))if(a===i)return e.AttributeHelpers.coerceString(i)},defaultValue:r.ALBUM_VIEW_LAYOUT_DEFAULT},galleryViewLayoutPref:{validator:function(t){return!!e.AttributeHelpers.validateString(t)&&Object.keys(r.GALLERY_VIEW_LAYOUT_TYPES).some((function(e){return r.GALLERY_VIEW_LAYOUT_TYPES[e]===t}))},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:r.GALLERY_VIEW_LAYOUT_DEFAULT},photostreamViewLayoutPref:{validator:function(t){return!!e.AttributeHelpers.validateString(t)&&Object.keys(r.PHOTOSTREAM_VIEW_LAYOUT_TYPES).some((function(e){return r.PHOTOSTREAM_VIEW_LAYOUT_TYPES[e]===t}))},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:r.PHOTOSTREAM_VIEW_LAYOUT_DEFAULT}}},{getReadablePrefName:function(e){return r.PHOTOSTREAM_VIEW_PREF_MAP[e]},buildContextSuffix:function(t,r){var i=e.Models["person-preferences-models"].getReadablePrefName(t.getValue("photostreamViewOrderPref")),a=e.Models["person-preferences-models"].getReadablePrefName(t.getValue("photostreamViewAsPref"));return a===e.Models["person-preferences-models"].PHOTOSTREAM_VIEW_PREF_MAP.me||t.id!==r?i:i+"-"+a}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-prefs-setSafeSearch-updater","attribute-helpers"]});