YUI.add("person-relationship-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,i){var r=[],n={};return e.Lang.isObject(i,!0)&&(n.user_id=t,n.friend=this.getValue(t,"isFriend"),n.family=this.getValue(t,"isFamily"),"isContact"in i&&(i.isContact.newVal?r.push(e.ModelUpdaters["flickr-contacts-add"].run(n,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-remove"].run(n,this.appContext))),("isFriend"in i||"isFamily"in i)&&("isFriend"in i&&(n.friend=i.isFriend.newVal),"isFamily"in i&&(n.family=i.isFamily.newVal),r.push(e.ModelUpdaters["flickr-contacts-edit"].run(n,this.appContext))),"isIgnored"in i&&(!0===i.isIgnored.newVal?r.push(e.ModelUpdaters["flickr-contacts-block"].run(n,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-unblock"].run(n,this.appContext)))),e.Promise.all(r)}},toggleFollowing:function(e){this.getValue(e,"isContact")?this.setValue(e,"isContact",!1):this.setValue(e,"isContact",!0)},toggleFriend:function(e){this.getValue(e,"isFriend")?this.setValue(e,"isFriend",!1):this.setValue(e,"isFriend",!0)},toggleFamily:function(e){this.getValue(e,"isFamily")?this.setValue(e,"isFamily",!1):this.setValue(e,"isFamily",!0)},toggleIgnore:function(e){this.getValue(e,"isIgnored")?this.setValue(e,"isIgnored",!1):this.setValue(e,"isIgnored",!0)},attributes:{pathAlias:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnoredBy:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnored:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMe:{readOnly:!0,getter:function(e,t){var i=this.appContext.getViewer();return!!i&&this.getValue(t,"nsid")===i.nsid}},nsid:{readOnly:!0,defaultFn:function(e){return e}}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-contacts-add-updater","flickr-contacts-remove-updater","flickr-contacts-edit-updater","flickr-contacts-block-updater","flickr-contacts-unblock-updater","attribute-helpers"]});YUI.add("math-helper",(function(e){e.MathHelper=function(e){return{seedRandom:function(e){return 0+1*((e=(9301*e+49297)%233280)/233280)}}}}),"@VERSION@",{requires:[]});YUI.add("banner-helper",(function(e,i){var n=require("hermes-core/flog")(i),r=e.mix({langBundles:this.details.langBundles},e.Localizable),o=new e.SubscriptionsHelper;e.BannerHelper=function(i){var t=this,a=[],s=[],l={"21stbdayExplore":function(n){var r=i.getViewer(),o="priority"in n?n.priority:Number.MAX_VALUE,t="placement"in n?n.placement:"header",a=new Date("Wed, 05 Feb 2025 08:00:00 GMT"),s=new Date("Tue, 16 Feb 2025 07:59:59 GMT");return i.flipper.isFlipped("enable-force-flickr-bday")&&(a=new Date),{priority:o,placement:t,load:function(){return Promise.resolve()},canShowBanner:function(){const n=i.flipper.isFlipped("enable-pre-flickr-bday")||i.flipper.isFlipped("enable-flickr-bday")||i.flipper.isFlipped("enable-force-flickr-bday"),o=!r.signedIn||!r.isPro;return!i.getCookie(e.config.flickr.banners.dismiss_21st_bday_banner_name)&&n&&o&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)},viewName:"21st-bday-banner-view",viewConfig:{},startTime:a,endTime:s}},ybsExploreBanner:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_ybsExplore_banner_name)&&"explore-page-view"===i.flapp.get("activeView").name},viewName:"ybsExplore-banner-view",viewConfig:{},startTime:new Date("Thu, 26 Dec 2024 05:00:00 GMT"),endTime:new Date("Fri, 27 Dec 2024 04:55:00 GMT")}},"digitalriver-redBanner":function(n){var r="priority"in n?n.priority:Number.MAX_VALUE,o="placement"in n?n.placement:"header",t=!1;return{priority:r,placement:o,load:function(){if(i.getViewer().signedIn){let e=i.flipper.isFlipped("enable-dr-winback-campaign-banner"),n=i.segments.hasSegment("dr_2025");return t=e&&n||i.flipper.isFlipped("enable-force-winback-campaign"),Promise.resolve()}return t=!1,Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_digitalriver_red_banner_name)&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)&&t},viewName:"digitalriver-red-banner-view",viewConfig:{}}},loginMigration:function(e){return{priority:"priority"in e?e.priority:Number.MAX_VALUE,placement:"placement"in e?e.placement:"header",load:function(){return Promise.resolve()},canShowBanner:function(){var e=!1,n=i.getViewer().isCognitoUser;return i.getViewer().signedIn&&!n&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)&&(e=!0),e},viewName:"login-migration-banner-view",viewConfig:{}}},pastDue:function(e){var n;function r(){return-1===["pro-checkout-view","sohp-slideshow-view","account-settings-view"].indexOf(i.flapp.get("activeView").name)}return{priority:"priority"in e?e.priority:Number.MAX_VALUE,placement:"placement"in e?e.placement:"header",load:function(){var e=i.getViewer();return e.signedIn&&e.isPro?i.getModel("person-models",e.nsid).then((function(e){var i=e.getValue("subscription");n=i.isPastDue})):(n=!1,Promise.resolve())},canShowBanner:function(){var e=!1;return i.getViewer().signedIn&&i.getViewer().isPro&&r()&&n&&(e=!0),e&&r()},viewName:"past-due-banner-view",viewConfig:{}}},cookie:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"footer",load:function(){return Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_cookie_banner_name)&&!i.requiresCookieConsent},viewName:"cookie-banner-view",viewConfig:{}}},cookieConsent:function(e){var n,r="priority"in e?e.priority:Number.MAX_VALUE,o="placement"in e?e.placement:"footer";return{priority:r,placement:o,load:function(){return i.trustarcConsentManager?new Promise(((e,r)=>{n=setTimeout(e,1e4),i.trustarcConsentManager.onReady((()=>{clearTimeout(n),e()}))})):Promise.resolve()},canShowBanner:function(){var e=i.flipper.isFlipped("enable-cookie-consent-execution-hermes")&&i.requiresCookieConsent&&"truste"in window&&"PrivacyManagerAPI"in window;if(e){var n=window.truste.cma.callApi("getConsentDecision","flickr.com");n&&(e=0===n.consentDecision)}return e},viewName:"trustarc-consent-banner-view",viewConfig:{}}},uploadLimitToast:function(n){var r,o,t;return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return(t=i.getViewer()).signedIn?Promise.all([i.getModel("person-profile-models",t.nsid),i.getModel("person-models",t.nsid)]).then((e=>{r=e[0],o=e[1]})):Promise.resolve()},canShowBanner:function(){if(!t.signedIn)return!1;if(t.isPro)return!1;var n=!i.getCookie(e.config.flickr.upload_blocking.dismiss_content_deletion_warning_cookie_name)&&i.flipper.isFlipped("enable-content-deletion-warnings")&&e.UserLimitsHelper.hasBeenWarnedAboutContentDeletion(o,i),a=!i.getCookie(e.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_name)&&e.UserLimitsHelper.isOverARRLimit(r,i)&&"products-flickrpro-route"!==i.routeConfig.module,s=!i.getCookie(e.config.flickr.upload_blocking.dismiss_at_upload_limit_message_cookie_name)&&e.UserLimitsHelper.isAtUploadLimit(r,i),l=!i.getCookie(e.config.flickr.upload_blocking.dismiss_near_upload_limit_message_cookie_name)&&e.UserLimitsHelper.isNearUploadLimit(r,i);return i.flipper.isFlipped("enable-upload-limit-messages")&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)&&(a||s||l||n)},viewName:"upload-limit-toast-view",viewConfig:{}}},contentDeletionWarning:function(n){var r,o;return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return(o=i.getViewer()).signedIn?i.getModel("person-models",o.nsid).then((e=>{r=e})):Promise.resolve()},canShowBanner:function(){return o.signedIn&&!o.isPro&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)&&!i.getCookie(e.config.flickr.upload_blocking.dismiss_content_deletion_warning_banner_cookie_name)&&i.flipper.isFlipped("enable-content-deletion-warnings")&&e.UserLimitsHelper.hasBeenWarnedAboutContentDeletion(r,i)},viewName:"content-deletion-warning-banner-view",viewConfig:{}}},accountSuspensionWarning:function(n){var r,o;return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return(o=i.getViewer()).signedIn?i.getModel("person-models",o.nsid).then((e=>{r=e})):Promise.resolve()},canShowBanner:function(){return o.signedIn&&!o.isPro&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)&&!i.getCookie(e.config.flickr.banners.dismiss_account_suspension_banner_name)&&i.flipper.isFlipped("enable-account-suspension-warnings")&&e.UserLimitsHelper.isSuspended(r,i)},viewName:"account-suspension-warning-banner-view",viewConfig:{}}},surveyModal:function(n){var r="priority"in n?n.priority:Number.MAX_VALUE,o="placement"in n?n.placement:"header";let t,a=new e.MathHelper,s="",l=(e.config.flickr.geo,i.lang?i.lang.substr(0,2):""),p=!1;return l&&["en"].indexOf(l)>-1&&(p=!0,s="LMLRJSP"),{priority:r,placement:o,load:function(){let e=i.getViewer();return e.signedIn?i.getModel("person-models",e.nsid).then((function(e){t=e,t.getValue("isPro")&&(p=!1)})):Promise.resolve()},canShowBanner:function(){let n=!1,r=t?t.getValue("nsid"):void 0,o=new URLSearchParams(window.location.search);if(i.flipper.isFlipped("enable-feedback-modal")){var l=!0,c=r?parseInt(r.substring(0,r.indexOf("@"))):(d=1e8,u=999999999,Math.floor(Math.random()*(u-d)+d));c&&(l=i.viewportData.getWidth()>700?a.seedRandom(c)<.03:a.seedRandom(c)<.15),!YUI.Env.isServer&&l&&i.getViewer().signedIn&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)&&"photostream-route"!==i.routeConfig.module&&!window.localStorage.getItem(e.config.flickr.banners.dismiss_survey_modal_name)&&window.URLSearchParams&&p&&(n=!0)}var d,u;return!i.flipper.isFlipped("enable-force-feedback-modal")||YUI.Env.isServer||window.localStorage.getItem(e.config.flickr.banners.dismiss_survey_modal_name)||(n=!0),i.flipper.isFlipped("enable-feedback-modal")&&o.has("survey")&&(n=!0),n&&s},viewName:"feedback-prompt-view",viewConfig:{surveyKey:s}}},defaultSafetyMigration:function(e){var n,t,a="priority"in e?e.priority:Number.MAX_VALUE,s="placement"in e?e.placement:"header",l=i.getViewer(),p=o.getProLandingPageUrl(o.UTM_SAFETY_UPSELL,{source:i.flapp.get("activeView").isMobile?"mobile":"desktop",medium:"defaultSafetyChangeModal"});return{priority:a,placement:s,load:function(){return l.signedIn?Promise.all([i.getModel("privileges-models",l.nsid),i.getModel("account-settings-models",l.nsid,{user_id:l.nsid})]).then((e=>{n=e[0],t=e[1]})).catch((e=>{console.log(e)})):Promise.resolve()},canShowBanner:function(){let e=!1;return YUI.Env.isServer||!l.signedIn||-1!==["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)||"safe"===t.getValue("permissions").defaultUploads.defaultSafetyLevel||n.getValue("privileges").canSetNonSafe||(e=!0),e},viewName:"confirmation-dialog-view",viewConfig:{appContext:i,title:r.intlMessage({intlName:"banners.DEFAULT_SAFETY_CHANGE_MODAL_TITLE"}),htmlMessage:r.intlMessage({intlName:"banners.DEFAULT_SAFETY_CHANGE_MODAL_BODY"})+"<br>"+r.intlHTMLMessage({intlName:"banners.DEFAULT_SAFETY_CHANGE_MODAL_MORE_INFO",blogPostURL:"https://www.flickrhelp.com/hc/en-us/articles/13690320471060-Free-account-limit-changes-and-enforcement"}),confirmButtonText:r.intlMessage({intlName:"banners.DEFAULT_SAFETY_CHANGE_MODAL_UPGRADE"}),cancelButtonText:r.intlMessage({intlName:"banners.DEFAULT_SAFETY_CHANGE_MODAL_CHANGE"}),showCloseXButton:!1,onConfirm:async(e,n)=>{n.setLoading({confirm:"loading"}),i.flapp.navigate(p)},onCancel:async(e,n)=>{n.setLoading({cancel:"loading"}),i.callAPI("flickr.prefs.setSafetyLevel",{safety_level:1}).then((function(e){var i;if("ok"!==e.stat)throw e;(i=t.getValue("permissions")).defaultUploads.defaultSafetyLevel="safe",t.setValue("permissions",i),n.fire("dismiss")}),(function(e){console.log(e)}))}},containerConfig:{dismissOnOverlayClick:!1}}},monthly2yOffer:function(n){var r="priority"in n?n.priority:Number.MAX_VALUE,t="placement"in n?n.placement:"header",a=!1;return{priority:r,placement:t,load:function(){var e=i.getViewer();return e.signedIn&&e.isPro?i.getModel("effective-subscriptions-models",e.nsid).then(function(e){if(e&&e.getValue("length")>0){var i=o.getEligibleSubscription(e,!0);!i||i.isGoogleOrAppleSubscription||i.futureChanges&&i.futureChanges.hasDiscount&&i.futureChanges.type===o.FLICKR_PRO_STRIPE_2_YEAR_PLAN_ID||(a=o.isAMonthlySub(i.type))}}.bind(this)):(a=!1,Promise.resolve())},canShowBanner:function(){var n=!1;return i.flipper.isFlipped("enable-monthly-2ypro-offer")&&i.getViewer().signedIn&&i.getViewer().isPro&&a&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)&&!i.getCookie(e.config.flickr.banners.dismiss_monthly_offer_2y_pro)&&(n=!0),n},viewName:"monthly-offer-2y-pro-banner-view",viewConfig:{}}},abandonedCartRecovery:function(n){let r="priority"in n?n.priority:Number.MAX_VALUE,o="placement"in n?n.placement:"header",t=!1,a=i.getViewer(),s=a&&a.isPro;return i.segments.inAbandonedCartRecoverySegment()&&(t=!0),{priority:r,placement:o,load:function(){return Promise.resolve()},canShowBanner:function(){return!s&&!i.getCookie(e.config.flickr.banners.dismiss_abandoned_cart_recovery_banner_name)&&i.flipper.isFlipped("enable-abandoned-carts-recovery")&&t&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)},viewName:"abandoned-cart-recovery-view",viewConfig:{}}},digitalRiverWinbackToast:function(n){let r="priority"in n?n.priority:Number.MAX_VALUE,o="placement"in n?n.placement:"header",t=i.getViewer().signedIn,a=!1;return{priority:r,placement:o,load:function(){if(t){let e=i.flipper.isFlipped("enable-dr-winback-campaign-toast"),n=i.segments.hasSegment("dr_2025");return a=e&&n||i.flipper.isFlipped("enable-force-winback-campaign"),Promise.resolve()}return a=!1,Promise.resolve()},canShowBanner:function(){return a&&!i.getCookie(e.config.flickr.banners.dismiss_digitalriver_red_toast_name)&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)},viewName:"digital-river-winback-toast-view",viewConfig:{}}},accountSuspensionToast:function(n){let r="priority"in n?n.priority:Number.MAX_VALUE,o="placement"in n?n.placement:"header",t=i.getViewer(),a=t.signedIn;t.isPro;var s;return{priority:r,placement:o,load:function(){return a?i.getModel("person-models",t.nsid).then((e=>{s=e})):Promise.resolve()},canShowBanner:function(){return t.signedIn&&!t.isPro&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)&&!i.getCookie(e.config.flickr.banners.dismiss_account_suspension_toast_name)&&i.flipper.isFlipped("enable-account-suspension-warnings")&&e.UserLimitsHelper.isSuspended(s,i)},viewName:"account-suspension-toast-view",viewConfig:{}}},visionInterestModal:function(n){let r,o="priority"in n?n.priority:Number.MAX_VALUE,t="placement"in n?n.placement:"header",a=["en"];return{priority:o,placement:t,load:function(){if(!i.flipper.isFlipped("enable-vision-interest-modal"))return Promise.resolve();let e=i.getViewer();return e.signedIn?i.getModel("person-models",e.nsid).then((function(e){r=e})):Promise.resolve()},canShowBanner:function(){if(!r)return!1;let n=r.getValue("segments").find((e=>"survey_vision_202410"===e)),o=i.lang?i.lang.substr(0,2):"",t=o&&a.indexOf(o)>-1,s=-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name),l=i.getCookie(e.config.flickr.banners.dismiss_vision_interest_modal);return n&&o&&t&&s&&!l},viewName:"vision-interest-prompt-view",containerConfig:{width:450}}},drWinbackPrompt:function(n){let r="priority"in n?n.priority:Number.MAX_VALUE,o="placement"in n?n.placement:"header",t=i.getViewer().signedIn,a=!1;return{priority:r,placement:o,load:function(){if(t){let e=i.flipper.isFlipped("enable-dr-winback-prompt"),n=i.segments.hasSegment("dr_2025");return a=e&&n||i.flipper.isFlipped("enable-force-winback-campaign"),Promise.resolve()}return a=!1,Promise.resolve()},canShowBanner:function(){return a&&!i.getCookie(e.config.flickr.banners.dismiss_digitalriver_winback_prompt_name)&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)},viewName:"dr-winback-prompt-view",containerConfig:{width:450}}},cc4LicensesAreHereBanner:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_cc4_licenses_are_here_banner_name)&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-view","download-page-view","chrome-page-view"].indexOf(i.flapp.get("activeView").name)},viewName:"cc4-licenses-are-here-banner-view",viewConfig:{},startTime:new Date("Wed, 18 Jun 2025 22:00:00 GMT"),endTime:new Date("Wed, 02 Jul 2025 22:00:00 GMT")}},exploreFlickrPhotogs:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_explore_flickr_photogs_banner_name)&&"explore-page-view"===i.flapp.get("activeView").name},viewName:"explore-flickr-photogs-banner-view",viewConfig:{},startTime:new Date("Thu, 26 Jun 2025 05:00:00 GMT"),endTime:new Date("Fri, 27 Jun 2025 04:55:00 GMT")}}};function p(){s=a.sort((function(e,i){return e.priority-i.priority}))}function c(e){var i,n,r=s.find((function(i,n){var r=void 0===e||i.placement===e,o=new Date,t=o<i.startTime||o>i.endTime;if(r&&!t&&i.canShowBanner())return!0}));if(r)return i=a.indexOf(r),-1!==(n=i)&&(a.splice(n,1),p()),r}return this.loadBanners=function(e){var i;return a=[],s=[],i=e.map((function(e){return(function(e){var i=new l[e.type]({priority:e.priority,placement:e.placement});return i?i.load().then((function(){!(function(e){a.push(e),p()})(i)})).catch((function(e){n.error("Failed to load and register banner.",{err:e})})):Promise.resolve()})(e)})),Promise.all(i)},this.getBanners=function(e){var i=[];return e.forEach((function(e){var n=c(e);n&&i.push(n)})),i},this.getQueue=function(){return s},this.typeObjects=l,this.renderBannerView=function(e){return(function(e){return i.getView(e.viewName,e.viewConfig).then((function(e){var n;return i.getView("banner-view",{subview:e}).then((function(e){return(n=e).initialize()})).then((function(){return n}))}),(function(e){n.warn("Error loading banner view",{err:e})}))})(e).then((function(i){t.fire("renderBanner",{placement:e.placement,bannerView:i,containerConfig:e.containerConfig})}))},this},e.augment(e.BannerHelper,e.EventTarget)}),"@VERSION@",{requires:["banner-view","event-custom","effective-subscriptions-models","person-models","subscriptions-helper","math-helper","moment"],optionalRequires:["hermes-core"],langBundles:["banners"]});YUI.add("hermes-lang-banners",(function(e,a){e.Intl.add("hermes/banners","en-US",{EXPLORE_CURATED_BANNER:[{type:0,value:'Today‚Äôs Explore was curated by Flickr staff. Learn more about this <a class="learn-link" href="'},{type:1,value:"learnURL"},{type:0,value:'" target="_blank">here</a>.'}],EXPLORE_OUTAGE_BANNER:[{type:0,value:'Sorry! Explore is down. Please <a class="status-link" href="'},{type:1,value:"statusUrl"},{type:0,value:'" target="_blank">visit our Status page</a> for details.'}],CHURNED_PRO:[{type:0,value:'Become a Flickr Pro and enjoy unlimited photo uploads, ad-free browsing, and more. For a limited time, <a class="banner-cap" href="'},{type:1,value:"url"},{type:0,value:'">get 25% off of the 2 Year Plan</a>.'}],DEFAULT_SAFETY_CHANGE_MODAL_TITLE:[{type:0,value:"Account update"}],DEFAULT_SAFETY_CHANGE_MODAL_BODY:[{type:0,value:"As a free member, your account is limited to safe uploads only. We will need to change your default upload settings to Safe. You can upgrade to Flickr Pro to upload moderate or restricted photos or allow us to change your default settings to Safe only."}],DEFAULT_SAFETY_CHANGE_MODAL_MORE_INFO:[{type:0,value:'<a href="'},{type:1,value:"blogPostURL"},{type:0,value:'">Learn more about Flickr‚Äôs policy changes here.</a>'}],DEFAULT_SAFETY_CHANGE_MODAL_UPGRADE:[{type:0,value:"Upgrade to Pro"}],DEFAULT_SAFETY_CHANGE_MODAL_CHANGE:[{type:0,value:"Change to safe"}],MFY_BANNER:[{type:0,value:"Relive your "},{type:1,value:"year"},{type:0,value:' on Flickr with MyFlickrYear. <a href="'},{type:1,value:"mfyURL"},{type:0,value:'">View '},{type:1,value:"hashTag"},{type:0,value:"</a>"}],DIGITALRIVER_RED_BANNER_TEXT:[{type:0,value:'[Big Savings Alert!] Renew your Flickr Pro subscription and <a href="'},{type:1,value:"url"},{type:0,value:'">save 30%</a>!'}],MFY_PROMO_TITLE:[{type:0,value:"MyFlickrYear is here!"}],MFY_PROMO_BODY:[{type:0,value:"MFY24 is buzzing! Start building for 2025 now. Post some photos, show your followers love, and if you‚Äôre not a Pro yet, get 20% off annual or 2-year plans to celebrate. üéâ"}],MFY_PROMO_CTA:[{type:0,value:"Get 20% off Flickr Pro"}],YBS_EXPLORE_BANNER_TEXT:[{type:0,value:'Today‚Äôs Explore Takeover highlights some of the Flickr Community‚Äôs amazing submissions to the Your Best Shot Contest. Enjoy this collection of inspiring and diverse images, then add your own best shot to <a class=‚Äúflickr-social-link" href="'},{type:1,value:"url"},{type:0,value:'" target="_blank">the official contest group</a> for a chance at some awesome prizes!'}],"YIR-2024_BANNER_TEXT":[{type:0,value:'Photography trends and insights from 2024 are here. <a href="'},{type:1,value:"url"},{type:0,value:'" target="_new">Explore the 2024 Flickr Year in Review</a>.'}],"YIR-2024_SIDEBAR_TITLE":[{type:0,value:"The Year in Photography"}],"YIR-2024_SIDEBAR_TEXT":[{type:0,value:"The Year in Photography: When our fingers aren‚Äôt on the shutter, they‚Äôre on the pulse of the photography world. Here‚Äôs the 2024 Flickr Year in Review."}],"YIR-2024_SIDEBAR_TEXT_2":[{type:0,value:"When our fingers aren‚Äôt on the shutter, they‚Äôre on the pulse of the photography world. Here‚Äôs the 2024 Flickr Year in Review."}],"YIR-2024_SIDEBAR_CTA":[{type:0,value:"Explore now."}],"YIR-EXPLORE_BANNER_TEXT":[{type:0,value:'Today‚Äôs Explore takeover is a recap of 2024 through the lenses of Flickr members. From world events to Flickr milestones, enjoy today‚Äôs Explore and then <a href="'},{type:1,value:"url"},{type:0,value:'" target="_new">check out our full Flickr Year in Review trends and insights here</a>!'}],FLICKR_DAY_RAIL_TITLE:[{type:0,value:"Flickr‚Äôs 21st Birthday!"}],FLICKR_DAY_RAIL_DESCRIP:[{type:0,value:"Celebrate 21 years of Flickr with 21% off Flickr Pro!"}],UNSUSPEND_TOAST_HEAD:[{type:0,value:"Account Suspended"}],UNSUSPEND_TOAST_BODY:[{type:0,value:'Your account is suspended for violating Free Account Limits. <a href="'},{type:1,value:"upgradeURL"},{type:0,value:'">Upgrade to Pro</a> to reactivate your account or check <a href="'},{type:1,value:"flickrMailURL"},{type:0,value:'">FlickrMail</a> for alternative options.'}],UNSUSPEND_TOAST_CTA:[{type:0,value:"Upgrade Now"}],UNSUSPEND_BANNER:[{type:0,value:'Your account is suspended for violating Free Account Limits. <a href="'},{type:1,value:"upgradeURL"},{type:0,value:'">Upgrade to Pro</a> or check <a href="'},{type:1,value:"flickrMailURL"},{type:0,value:'">FlickrMail</a> for more information.'}],FLICKR_21_BIRTHDAY_BANNER:[{type:0,value:'Celebrate 21 years of Flickr with 21% off Flickr Pro! <a href="'},{type:1,value:"ctaUrl"},{type:0,value:'">Upgrade now.</a>'}],DISCOVER_PAGE_BANNER_TEXT:[{type:0,value:'Join Flickr Groups to connect with passionate photography enthusiasts! <a href="'},{type:1,value:"ctaUrl"},{type:0,value:'">Join groups now!</a>'}],DISCOVER_PAGE_SIDEBAR_TITLE:[{type:0,value:"Discover Flickr!"}],DISCOVER_PAGE_SIDEBAR_TEXT:[{type:0,value:"Join Flickr Groups to connect with passionate photography enthusiasts!"}],DISCOVER_PAGE_SIDEBAR_CTA:[{type:0,value:"Join groups now!"}],WOMEN_HISTORY_MONTH_BANNER:[{type:0,value:'Join us in celebrating Women‚Äôs History Month by honoring the amazing women photographers on Flickr, in today‚Äôs Explore Takeover. Enjoy this collection that features these amazing photographers, then join us in <a href="'},{type:1,value:"ctaUrl"},{type:0,value:'">Flickr Social</a> to share some of your favorites!'}],MOMDAY_BANNER_TEXT:[{type:0,value:'Last chance! Enter the ‚ÄúMany Faces of Mom‚Äù contest for a chance to win Flickr Pro and other fun prizes. <a href="'},{type:1,value:"url"},{type:0,value:'">Join in</a>.'}],CC4_LICENSES_ARE_HERE_BANNER:[{type:0,value:'Creative Commons 4.0 licenses are here! <a href="'},{type:1,value:"ctaURL"},{type:0,value:'" target="_blank">Find out about the new license options<a/>.'}],EXPLOR_FLICKR_PHOTOGS:[{type:0,value:'Today‚Äôs Explore takeover features travel photography captured by the Flickr community! Share some of your favorites from Explore on <a href="'},{type:1,value:"learnURL"},{type:0,value:' target="_blank">Flickr Social<a/> today!'}]})}),"@VERSION@",{requires:["intl"]});YUI.add("storage-helper",(function(e){e.StorageHelper={setItem:function(t,i,n){var o=n?"sessionStorage":"localStorage";if(e.config.win)try{e.config.win[o][t]=i}catch(e){}},getItem:function(t,i){var n,o=i?"sessionStorage":"localStorage";if(e.config.win)try{n=e.config.win[o][t]}catch(e){}return n},remove:function(t,i){var n=i?"sessionStorage":"localStorage";if(e.config.win)try{e.config.win[n].removeItem(t)}catch(e){}},hasEntries:function(t,i){var n=i?"sessionStorage":"localStorage",o=!1;if(e.config.win)try{o=void 0!==e.config.win[n][t]}catch(e){}return o},isLocalStorageAvailable:function(){var t="checkLSCompat",i=!1;try{e.config.win.localStorage[t]="checkLSCompatValue",e.config.win.localStorage.removeItem(t),i=!0}catch(e){i=!1}return i}},e.Storage={Instance:{_cache:{},_hasSessionStorage:!0,_clientIdKey:"",getClientIdKey:function(){return this._clientIdKey||(this._clientIdKey=e.config.win.appContext.clientId+"_"),this._clientIdKey},get:function(t){var i,n;try{t=t||"",i=this.getClientIdKey()+t,n=this._hasSessionStorage?e.config.win.sessionStorage.getItem(i):this._cache[i]}catch(e){this._hasSessionStorage=!1}return n},set:function(t,i){var n;try{t&&(n=this.getClientIdKey()+t,this._hasSessionStorage?e.config.win.sessionStorage.setItem(n,i):this._cache[n]=i)}catch(e){this._cache[n]=i,this._hasSessionStorage=!1}},has:function(t){var i,n=!1;try{i=this.getClientIdKey()+t,n=this._hasSessionStorage?!!e.config.win.sessionStorage.getItem(i):!!this._cache[i]}catch(e){this._hasSessionStorage=!1}return n},remove:function(t){var i;try{t=t||"",i=this.getClientIdKey()+t,this._hasSessionStorage?e.config.win.sessionStorage.removeItem(i):this._cache[i]=void 0}catch(e){this._hasSessionStorage=!1}},clear:function(){this.clearByKey(this.getClientIdKey())},clearByKey:function(t){var i,n,o,s=[];try{if(t)if(this._hasSessionStorage){for(i=0,o=e.config.win.sessionStorage.length;i<o;i++)(n=e.config.win.sessionStorage.key(i))&&0===n.indexOf(t)&&s.push(n);for(i=0,o=s.length;i<o;i++)e.config.win.sessionStorage.removeItem(s[i])}else for(e.Object.each(this._cache,(function(e,i){0===i.indexOf(t)&&s.push(i)})),i=0,o=s.length;i<o;i++)this._cache[s[i]]=void 0}catch(e){this._hasSessionStorage=!1}}}}}),"@VERSION@",{requires:[]});YUI.add("cookie-catcher",(function(e,o){"use strict";var n=require("hermes-core/flog")(o);function t(o,n){this.cookieLevelBuckets=n,this.appContext=o,this.expireTime=new Date((new Date).getTime()+864e5*e.config.flickr.cookie_consent.consent_context_expiration_days),this.cookieConsentEnabled=this.appContext.flipper.isFlipped("enable-cookie-consent-execution-hermes")}t.prototype.getCookieLevel=function(e){return-1!==this.cookieLevelBuckets.required.indexOf(e)?0:-1!==this.cookieLevelBuckets.functional.indexOf(e)?1:-1!==this.cookieLevelBuckets.advertising.indexOf(e)?2:null},t.prototype.setCookieIfAllowed=function(o,n,t){if(this.cookieConsentEnabled&&this.appContext.requiresCookieConsent){var i=this.getCookieLevel(o),c=this.appContext.cookieConsentContext?this.appContext.cookieConsentContext.info.cookieBlock.level:0;(null===i||i<=c&&!YUI.Env.isServer)&&e.Cookie.set(o,n,t)}else e.Cookie.set(o,n,t)},t.prototype.getCookieConsentContext=function(){var o=this.appContext.getCookie(e.config.flickr.cookie_consent.consent_context_name),n={};if(n=this.appContext.flipper.isFlipped("enable-geoblock-cookie-consent")?{needsConsent:0,managed:0,changed:0,info:{cookieBlock:{level:0,blockRan:0}}}:{managed:0,changed:0,info:{cookieBlock:{level:0,blockRan:0}}},o)try{n=JSON.parse(o)}catch(o){this.setCookieIfAllowed(e.config.flickr.cookie_consent.consent_context_name,JSON.stringify(n),{path:"/",domain:e.config.flickr.cookies.domain,expires:this.expireTime})}else this.setCookieIfAllowed(e.config.flickr.cookie_consent.consent_context_name,JSON.stringify(n),{path:"/",domain:e.config.flickr.cookies.domain,expires:this.expireTime});return n},t.prototype.updateConsentContext=function(o){var t=this.appContext.cookieConsentContext;t.info.cookieBlock.level!==o&&(t.changed=1,t.info.cookieBlock.level=o,this.setCookieIfAllowed(e.config.flickr.cookie_consent.consent_context_name,JSON.stringify(t),{path:"/",domain:e.config.flickr.cookies.domain,expires:this.expireTime}),e.Snowplough?e.Snowplough.sendStructuredEvent({category:"cookie_consent",action:"consent_update",value:o+".0"}):n.error("Missing Y.Snowplough in CookieCatcher.prototype.updateConsentContext"),console.log("cd refresh"),e.config.win.location.reload())},t.prototype.handleConsentManagerChoice=function(){var e;try{(e=window.truste.cma.callApi("getConsentDecision","flickr.com"))&&e.consentDecision&&Number.isInteger(e.consentDecision)&&this.updateConsentContext(e.consentDecision-1)}catch(e){console.log(e)}},e.namespace("CookieCatcher"),e.CookieCatcher=t}),"@VERSION@",{requires:["cookie","io-base","json-parse","storage-helper","murmurhash","url"],optionalRequires:["hermes-core"]});YUI.add("stacking-overlay-manager",(function(e,i){var n=require("hermes-core/flog")(i);e.StackingOverlayManager=function(i){var r,o,s=[],t={},a={push:function(n,a){var l,d,c=Object.assign({id:e.guid(),view:void 0,overlayClassList:"",hideOverlay:!1,dismissOnOverlayClick:!0,dismissOnEsc:!0,ignorePointerEvents:!1,disableBodyScroll:!0,popBeforePushOther:!1,requiredParentNode:void 0,showFlickrBalls:!1},n),v=e.one("#stacking-overlay-container"),u=this.findFirstPopBeforePushOverlay();if(u){this.isRequiredParent(u,[...s,c])||this.pop(u.id)}return v.setStyles({display:"block"}),s.push(c),l=e.Node.create('<div class="fluid-modal-overlay"></div>'),c.showFlickrBalls&&l.append('<div class="balls"></div>'),l.addClass("fluid-modal-overlay"),c.overlayClassList&&l.addClass(c.overlayClassList),c.hideOverlay&&l.addClass("transparent"),c.ignorePointerEvents&&l.addClass("invisible"),v.append(l),d=l.on("click",this.handleClick.bind(this)),t[c.id]={overlay:c,node:l,clickHandler:d},c.disableBodyScroll&&e.one("body").setStyles({overflow:"hidden"}),r||(r=e.one("body").on("keyup",this.handleKeyPress.bind(this))),o||(o=i.flapp.on("activeViewChange",this.handleActiveViewChange.bind(this))),c.id},pop:function(i){var n=this;if(i){var t=s.length-1;s.find((function(e,n){return t=n,e.id===i}))&&s.slice(t,s.length).reverse().forEach((function(i,r){i.isPopped||(n.fire("pop",{overlay:i}),i.isPopped=!0,n.closeView(i),n.findFirstDisableBodyScrollOverlay()===i&&e.one("body").setStyles({overflow:"visible"}),s.pop(),n.fire("popped",{overlay:i}),n.deleteOverlay(i))}))}s.length<=0&&(e.one("#stacking-overlay-container").setStyles({display:"none"}),r&&(r.detach(),r=void 0),o&&(o.detach(),o=void 0))},deleteOverlay:function(e){var i=t[e.id];i&&(i.clickHandler.detach(),i.node.remove(),delete t[e.id])},handleClick:function(e){var i=e.target,n=s.find((function(e){return t[e.id].node===i}));n.dismissOnOverlayClick&&this.pop(n.id)},handleKeyPress:function(e){if(27===e.keyCode){var i=this.findLastDismissOnEscOverlay();i&&this.pop(i.id)}},placeViewAfterOverlay:function(e){var i=t[e];i&&i.overlay.view&&i.node.insert(i.overlay.view.get("container"),"after")},findLastDismissOnEscOverlay:function(){return s.slice().reverse().find((function(e){return e.dismissOnEsc}))},findFirstDisableBodyScrollOverlay:function(){return s.find((function(e){return e.disableBodyScroll}))},findFirstPopBeforePushOverlay:function(){return s.find((function(e){return e.popBeforePushOther}))},isRequiredParent:function(e,i){return!!i.find((i=>i.requiredParentNode&&e.view&&e.view.get("container").contains(i.requiredParentNode)))},closeView:function(e){e&&e.view&&(e.view.close?e.view.close():(n.warn("The overlay associated with the view "+e.view.name+" was popped, but the view has no close function. Consider implementing one."),e.view.destroy({remove:!0})))},handleActiveViewChange:function(e){this.popAll()},popAll:function(){var e=s.length>0?s[0]:void 0;e&&this.pop(e.id)},hasOverlay:function(){return s.length>0},top:function(){return this.hasOverlay()?s[s.length-1]:void 0},getOverlay:function(e){return t[e]}};return e.augment(a,e.EventTarget),a}}),"@VERSION@",{requires:["event-custom"],optionalRequires:["hermes-core"],langBundles:["common"]});YUI.add("trustarc-consent-manager",(function(e,n){require("hermes-core/flog")(n);e.TrustarcConsentManager=function(n){var t,o,i,r=this,a=!1,c=n.cookieConsentContext;function s(t){var o;if(t&&t.data&&t.origin===window.location.origin){try{o=JSON.parse(t.data)}catch(e){return}if(o&&(o.PrivacyManagerAPI||o.PrivacyManagerAPI)){var i={},r=e.config.win.PrivacyManagerAPI.callApi("getGDPRConsentDecision",e.config.win.location.host).consentDecision;r&&r.forEach((function(e){i[e]||(i[e]=1)})),r.length&&0!==r[0]&&n.cookieCatcher.handleConsentManagerChoice()}}}function l(){if("truste"in window&&"PrivacyManagerAPI"in window){clearTimeout(o);var n=e.config.win.postMessage&&setInterval((function(){if(e.config.win.PrivacyManagerAPI&&n){var t={PrivacyManagerAPI:{action:"getConsentDecision",timestamp:(new Date).getTime(),self:e.config.win.location.host}};e.config.win.top.postMessage(JSON.stringify(t),"*"),n=clearInterval(n)}}),50);e.config.win.addEventListener("message",s.bind(this)),t=e.one("body").all(".trustarc-cookie-pref-link").on("click",f),a=!0,r.fire("ready")}else o=setTimeout(l.bind(this),250)}function u(){var t=e.one("#consent_blackbar");n.trustArcBannerClone?(clearTimeout(i),e.one("body").appendChild(n.trustArcBannerClone)):t?(clearTimeout(i),n.trustArcBannerClone=t):i=setTimeout(u.bind(this),100)}function f(n){var t=e.one("#consent_blackbar");return n.halt(),t&&t.addClass("active"),e.config.win.truste.eu.reopenBanner(),a=!0,r.fire("reopen"),!1}return this.load=function(){if(a=!1,!n.requiresCookieConsent)return this;if(e.Snowplough&&c.freshServerContext){var t=new Date((new Date).getTime()+864e5*e.config.flickr.cookie_consent.consent_context_expiration_days);e.Snowplough.sendStructuredEvent({category:"cookie_consent",action:"consent_new"}),delete c.freshServerContext,n.cookieCatcher.setCookieIfAllowed(e.config.flickr.cookie_consent.consent_context_name,JSON.stringify(c),{path:"/",domain:e.config.flickr.cookies.domain,expires:t})}return l(),u(),this},this.reset=function(){e.one("#consent_blackbar"),n.trustArcBannerClone&&n.trustArcBannerClone.getDOMNode()&&n.trustArcBannerClone.removeClass("active"),t&&(t.detach(),t=void 0),clearTimeout(o),clearTimeout(i),o=void 0,i=void 0},this.onReady=function(e){if(!a)return r.on("ready",e);e()},this},e.augment(e.TrustarcConsentManager,e.EventTarget)}),"@VERSION@",{requires:["promise"],optionalRequires:["hermes-core"],langBundles:["common"]});YUI.add("datalayer",(function(e,a){var r=require("hermes-core/flog")(a);function t(e){this.appContext=e}t.prototype.initDataLayer=function(){YUI.Env.isServer?r.error("Server cant set data layer"):(window.fDataLayer=window.fDataLayer||{page:{pageID:"",pageName:"",destinationURL:"",referringURL:"",onsiteSearchTerm:"",author:"",safetyLevel:"",tags:[],camera:{make:"",model:"",name:"",type:""},geo:{country:"",region:"",city:""}},user:{profileInfo:{profileID:"",userName:"",language:"",intl:"",signedIn:!1},address:"",segments:{isNewRegistration:null,isUserNewCustomer:null,customerClassDimension:"",visitorLifetimeValue:0,pro:!1,list:[]}}},r.info("Init dataLayer",window.fDataLayer))},t.prototype.updateDataLayer=function(){if(YUI.Env.isServer)r.error("Server cant set data layer");else{window.fDataLayer||this.initDataLayer();try{var a=this.appContext.getViewer()||null;a&&(a.signedIn?(window.fDataLayer.user.profileInfo.signedIn=!0,window.fDataLayer.user.profileInfo.profileID=a.nsid,window.fDataLayer.user.profileInfo.intl=a.intl,window.fDataLayer.user.segments.pro=!!a.isPro,window.fDataLayer.user.segments.list=a.segments||[]):window.fDataLayer.user.profileInfo.signedIn=!1),window.navigator&&window.navigator.language&&(window.fDataLayer.user.profileInfo.language=window.navigator.language),window.fDataLayer.page.photoId=null,window.fDataLayer.page.geo={country:"",region:"",city:""},window.fDataLayer.page.camera={make:"",model:"",name:"",type:""},window.fDataLayer.page.pageID=e.murmurhash(document.title,document.title+" insecure hawaiian volcano salt"),window.fDataLayer.page.pageName=this.appContext.flapp.get("activeView").name,window.fDataLayer.page.destinationURL=document.location.href,r.info("Updated dataLayer")}catch(e){r.error("Error updating data layer"),r.error(e)}}},t.prototype.setDataLayerProp=function(a,t){!YUI.Env.isServer&&window.fDataLayer?(e.Object.setValue(window.fDataLayer,a.split("."),t),r.info("Set data layer prop "+a+" = "+t)):r.error("Data layer unavailable.")},e.namespace("DataLayer"),e.DataLayer=t}),"@VERSION@",{requires:["murmurhash"],optionalRequires:["hermes-core"]});YUI.add("getty-helper",(function(t,e){"use strict";var i=require("hermes-core/flog")(e);function o(t){this.appContext=t,this.colors={0:{color:"#ff2000"},1:{color:"#a24615"},2:{color:"#ff7c00"},b:{color:"#ff9f9c"},4:{color:"#fffa00"},3:{color:"#ffcf00"},5:{color:"#90e200"},6:{color:"#00ab00"},7:{color:"#00b2d4"},8:{color:"#0062c6"},9:{color:"#8c20ba"},a:{color:"#f52394"},c:{color:"#ffffff"},d:{color:"#7c7c7c"},e:{color:"#000000"}},this.isMobile,this.geo,this.widgetSiblingCount=2,this._cache={widgets:{},models:{},widgetOrder:[],searchTerm:"adventure"},this.widgetDefaultSearchTerm="adventure",this.previousPhotoId=null}o.prototype.setPreviousPhotoId=function(t){this.previousPhotoId=t},o.prototype.cacheWidget=function(e,o,r,a){let s=t.guid();return this.getModelById(o)||(this._cache.models[o]={},this._cache.models[o].regName=e,this._cache.models[o].lastImageIndex=0,this._cache.models[o].modelImages=r),this.getWidgetById(s)?i.error("Error: WidgetID already exists"):(this._cache.widgets[s]={},this._cache.widgets[s].modelId=o,this._cache.widgets[s].params=a,this._cache.widgets[s].widgetImages=[],this._cache.widgets[s].siblingIds=[],this._cache.widgets[s].imageIds={},this._cache.widgetOrder.push(s)),this.setWidgetSiblings(),this.setImagesInWidget(s),this.updateClassVariables(a),s},o.prototype.clearCache=function(t){let e=!0;("photoPage"===t||"interstitial"===t&&this.nextPhotoId)&&(e=!1),e&&(this._cache.widgets={},this._cache.models={},this._cache.widgetOrder=[],this.previousModelConfig=null)},o.prototype.setWidgetSiblings=function(){let t=2*this.widgetSiblingCount,e={},i={};this._cache.widgetOrder.forEach(((o,r)=>{let a=this.getWidgetById(o);a.siblingIds.length!==t&&(e=this.getOlderSiblingWidgets(r),i=this.getYoungerSiblingWidgets(r),a.siblingIds=[],a.siblingIds=a.siblingIds.concat(e),a.siblingIds=a.siblingIds.concat(i))}))},o.prototype.getOlderSiblingWidgets=function(t){let e=this.widgetSiblingCount,i=this._cache.widgetOrder,o=[];if(t>0)for(let r=t-1;r>=0&&e>0;r--,e--)o.push(i[r]);return o},o.prototype.getYoungerSiblingWidgets=function(t){let e=this.widgetSiblingCount,i=this._cache.widgetOrder,o=[];if(t>=0&&t<i.length)for(let r=t+1;r<i.length&&e>0;r++,e--)o.push(i[r]);return o},o.prototype.siblingHasImage=function(t,e){let i=this.getWidgetById(t),o=!1;return i.siblingIds.forEach((t=>{this.getWidgetById(t).imageIds[e]&&(o=!0)})),o},o.prototype.isPhotopageInterstitialWidget=function(){let t=this.appContext.viewportData.getWidth();return this.appContext.flipper.isFlipped("enable-getty-photo-interstitial-widget")&&t&&t>=700},o.prototype.setImagesInWidget=function(t,e=10){let i=this.getWidgetById(t),o=i.widgetImages,r=i.modelId,a=r?this.getModelById(r):{},s=i.imageIds,n=a.modelImages,l=0,g=0;if(this.isPhotopageInterstitialWidget()&&(e=24),Object.keys(a).length>0){for(let r=a.lastImageIndex;e>0;r++)g>1?(o.push(n[r]),s[n[r].image_id]=!0,l=r+1,e--,g=0):n[r]?this.siblingHasImage(t,n[r].image_id)||i.imageIds[n[r].image_id]||(o.push(n[r]),s[n[r].image_id]=!0,l=r+1,e--):(r=0,a.lastImageIndex=0,n=this.randomizeImages(n),g++);l>n.length||l===n.length?(a.lastImageIndex=0,n=this.randomizeImages(n)):a.lastImageIndex=l}},o.prototype.randomizeImages=function(t){let e=t;for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e},o.prototype.updateClassVariables=function(t){this.isMobile=t.isMobile,this.geo=t.geo},o.prototype.getModelById=function(t){return this._cache.models[t]||null},o.prototype.getWidgetById=function(t){return this._cache.widgets[t]||null},o.prototype.getInterstitialWidget=function(){const e=this.appContext.flipper.isFlipped("enable-getty-photo-interstitial-widget"),i=this.appContext.viewportData.getWidth()||null;let o=t.one(".height-controller"),r=30*((o?o.get("clientHeight"):500)-80)/100,a={rowWidth:500,rowHeight:140,rowCount:1};return e&&("a"===e?(i&&(a.rowWidth=50*i/100),a.rowCount=2,a.rowHeight=170<=r?170:r):"b"===e?(i&&(a.rowWidth=35*i/100),a.rowCount=2,a.rowHeight=150<=r?150:r):"c"===e&&(i&&(a.rowWidth=70*i/100),a.rowHeight=250<=r?250:r)),a},o.prototype.canShowWidgetType=function(t){var e=!0,i=this.appContext.viewportData.getWidth()+this.appContext.viewportData.getScrollbarWidth();return(this.isMobile||this.appContext.getViewer().isPro||this.geo&&this.geo.countryCode&&"VN"===this.geo.countryCode||i&&i<=700||!this.appContext.flipper.isFlipped("enable-getty-signed-in"))&&(e=!1),t&&["explorePage","trendTagsPage"].includes(t)&&(e=!1),e},o.prototype.getSearchColorHex=function(t){var e="";if(t.modelParams&&t.modelParams.apiParams&&t.modelParams.apiParams.color_codes&&(e=t.modelParams.apiParams.color_codes.toString()),e.length>0){if(1===e.length)return this.colors[e].color;if(e.length>1){var i=e.split(","),o=i.length-1;return this.colors[i[o]].color}}},o.prototype.getSearchOrientation=function(t){var e=null;if(t.modelParams&&t.modelParams.apiParams&&t.modelParams.apiParams.orientation&&(e=t.modelParams.apiParams.orientation),e){var i={landscape:"horizontal",portrait:"vertical",square:"square",panorama:"panoramic_horizontal"},o="";return e.split(",").forEach((function(t){o.length?o+=","+i[t]:o+=i[t]})),o}return"horizontal,vertical,square,panoramic_horizontal"},o.prototype.getCorrectLangFormat=function(){var t=this.appContext.lang;return"pt-BR"===t||"zh-HK"===t||"en-US"===t?t:t.split("-")[0]},o.prototype.appendGettyTracking=function(t={campaign:"",term:"",pageUrl:"",originalURL:"",extraParams:""}){let e,i="utm_source=flickr",o="utm_medium=affiliate",r=`utm_campaign=${t.campaign}`,a=`utm_content=${encodeURIComponent(t.pageUrl)}`,s=`utm_term=${t.term}`;return e=t.extraParams?`${t.originalURL}${t.extraParams}&${i}&${o}&${r}&${s}&${a}`:`${t.originalURL}?${i}&${o}&${r}&${s}&${a}`,e+="&ref=sponsored",e},t.namespace("GettyHelper"),t.GettyHelper=o}),"@VERSION@",{requires:["flickr-promise"],optionalRequires:["hermes-core"]});