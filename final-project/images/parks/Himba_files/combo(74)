YUI.add("group-guidelines",(function(e){e.GroupGuidelines={getTemplateForCurrentLang:function(i){const t=new e.TemplateLibraryHelper(i),l=i.lang,n="en-US"===l?"group-guidelines":`group-guidelines_${l}`;return t.getTemplate(n)({})},showModal:function(i){const t=e.mix({langBundles:["groups","common"]},e.Localizable);new e.Views.FluidModal({appContext:i,subview:new e.Views["confirmation-dialog-view"]({appContext:i,title:t.intlMessage({intlName:"groups.GROUP_GUIDELINES"}),htmlMessage:e.GroupGuidelines.getTemplateForCurrentLang(i),showCancelButton:!1,confirmButtonText:t.intlMessage({intlName:"common.DONE"})}),width:860,height:640,hasSubviewConfigRefactor:!0,flexLayout:!0}).show()}}}),"@VERSION@",{requires:["template-lib-helper","localizable","hermes-template-group-guidelines","hermes-template-group-guidelines_de-DE","hermes-template-group-guidelines_es-US","hermes-template-group-guidelines_fr-FR","hermes-template-group-guidelines_id-ID","hermes-template-group-guidelines_it-IT","hermes-template-group-guidelines_ko-KR","hermes-template-group-guidelines_pt-BR","hermes-template-group-guidelines_vi-VN","hermes-template-group-guidelines_zh-HK"],langBundles:["groups","common"]});YUI.add("group-creation-view",(function(t,e){var i=require("hermes-core/flog")(e),o={4:{default:"add-to-stuff.ALREADY_GROUP_WITH_NAME"}},n="0",s="2",r="1",a="2",h="3",l="0",c="1";t.namespace("Views")[this.name]=t.Base.create("group-creation-view",t.Views["stuff-creation-view"],[],{langBundles:this.details.langBundles,initializer:function(t){return this.labelList=[{title:"<span>"+this.intlMessage({intlName:"add-to-stuff.CURATIONS_CREATE_A_NEW_GROUP"})+"</span>",cancelText:this.intlMessage({intlName:"common.CANCEL"}),actionText:this.intlMessage({intlName:"stats.NEXT"})},{title:this.intlMessage({intlName:"add-to-stuff.ABOUT_YOUR_GROUP"}),cancelText:this.intlMessage({intlName:"stats.PREVIOUS"}),actionText:this.intlMessage({intlName:"stats.NEXT"})},{title:this.intlMessage({intlName:"groups.GROUP_SAFETY_LEVEL"}),cancelText:this.intlMessage({intlName:"stats.PREVIOUS"}),actionText:this.intlMessage({intlName:"groups.CREATE_GROUP"})}],this.curationType="group",this.titleError=this.intlMessage({intlName:"add-to-stuff.PLEASE_ENTER_GROUP_NAME"}),this.createError=this.intlMessage({intlName:"add-to-stuff.COULDNT_SAVE_GROUP"}),this.photoId=t.photoId,this.groupOptions={ageRestriction:l,privacy:h,safety:n},this.constructor.superclass.initializer.call(this,t)},loadState:function(){var e=this;return this.photoId?this.appContext.getModel("photo-models",this.photoId).then((function(t){var i=t.getValue("safetyLevel");e.photoModel=t,e.groupOptions.safety=i?i.toString():n})):t.Promise.resolve()},buildContainer:function(){return this.activeStep=0,this.setContainerWithTemplate("group-creation-view",{heading:this.labelList[0].title,cancelText:this.labelList[0].cancelButton,actionText:this.labelList[0].actionButton,lang:this.appContext.lang.replace(/\-/g,"_"),urls:{groupGuidelines:"/groups_guidelines.gne",help:"https://www.flickrhelp.com/hc/en-us/search?query=groups",age:"https://flickrhelp.com/hc/en-us/articles/4404070473364-Flickr-group-administration-options",termsOfService:"/atos/pro",commGuidelines:"/help/guidelines"},safetyLevel:this.groupOptions.safety}),this},activate:function(){var e=this,i=this.get("container");this.headTitleNode=i.one(".title"),this.actionContainer=i.one(".action-container"),this.cancelButton=i.one(".button-cancel"),this.actionButton=i.one(".button-action"),this.closeButton=i.one(".close-x-button"),this.titleNode=i.one(".group-name"),this.descriptionNode=i.one(".group-description"),this.titleErrorNode=i.one(".error-message.title-error"),this.createErrorNode=i.one(".error-message.create-error"),this.privateGroupInput=i.one("#private-group"),this.ageRadioContainer=i.one(".group-age"),this.privacyRadioContainer=i.one(".group-privacy"),this.privateGroupOptionContainer=i.one(".private-group-option-container"),this.headTitleNode.set("innerHTML",this.labelList[0].title),this.cancelButton.set("text",this.labelList[0].cancelText),this.actionButton.set("text",this.labelList[0].actionText),this.registerEventHandler(this.privacyRadioContainer.on("change",this.handlePrivacyRadioChange.bind(this))),this.registerEventHandler(this.ageRadioContainer.on("change",this.handleAgeRadioChange.bind(this))),this.registerEventHandler(this.cancelButton.on("click",this.handleCancel.bind(this))),this.registerEventHandler(this.actionButton.on("click",this.handleAction.bind(this))),this.registerEventHandler(this.closeButton.on("click",function(){e.fire("readyToClose")}.bind(this))),this.registerEventHandler(this.titleNode.on("keyup",function(){this.titleNode.get("value")&&this.showError(this.titleErrorNode,!1)}.bind(this))),this.registerEventHandler(this.privacyRadioContainer.on("keydown",this.handlePrivacyKeyPress.bind(this))),this.registerEventHandler(this.ageRadioContainer.on("keydown",this.handleAgeKeyPress.bind(this))),this.registerEventHandler(i.one(".group-creation-content-container").delegate("click",(e=>{e.preventDefault(),t.GroupGuidelines.showModal(this.appContext)}),".step-description .guidelines-link")),this.constructor.superclass.activate.call(this,this.params)},handleCancel:function(){this.activeStep>0?this.goToStep(this.activeStep-1):this.params.inlineCreation?(this.fire("cancel"),this.resetView()):this.fire("readyToClose")},handleAction:function(){0===this.activeStep?this.goToStep(this.activeStep+1):1===this.activeStep?this.titleNode.get("value")?this.goToStep(this.activeStep+1):this.showError(this.titleErrorNode,!0,this.titleError):this.titleNode.get("value")?(this.showError(this.createErrorNode,!1),this.createCuration().then(function(t){this.fire("created",{type:this.curationType,curation:t}),this.params.inlineCreation?this.resetView():this.fire("readyToClose")}.bind(this)).catch(function(t){var e=t.code;4===e&&o.hasOwnProperty(e)?(this.goToStep(1),this.showError(this.titleErrorNode,!0,this.intlMessage({intlName:o[e].default}))):this.showError(this.createErrorNode,!0,this.createError)}.bind(this))):(this.goToStep(1),this.showError(this.titleErrorNode,!0,this.titleError))},handlePrivacyKeyPress:function(t){var e=t.keyCode,i=t.target.ancestor(".radio",!0).one(".toggle-input"),o=i.get("type");13===e&&("radio"===o?i.get("checked")||(i.set("checked",!0),this.handlePrivacyRadioChange(t)):(i.set("checked",!i.get("checked")),this.handlePrivacyRadioChange(t)))},handleAgeKeyPress:function(t){var e=t.keyCode,i=t.target.ancestor(".radio",!0).one(".toggle-input"),o=i.hasAttribute("disabled");13!==e||i.get("checked")||o||(i.set("checked",!0),this.handleAgeRadioChange(t))},handlePrivacyRadioChange:function(t){var e=t.target.ancestor(".radio",!0);e.hasClass("public-group")?(this.privateGroupOptionContainer.addClass("hidden"),this.privateGroupInput.set("checked",!1),this.groupOptions.privacy=h):e.hasClass("invite-only-group")?(this.privateGroupOptionContainer.removeClass("hidden"),this.groupOptions.privacy=a):e.hasClass("private-group")&&(e.one(".toggle-input").get("checked")?this.groupOptions.privacy=r:this.groupOptions.privacy=a),this.fire("contentSizeChanged")},handleAgeRadioChange:function(t){var e=t.target.get("id");"all-age-group"===e?this.groupOptions.ageRestriction=l:"adult-group"===e&&(this.groupOptions.ageRestriction=c,this.groupOptions.safety=s)},goToStep:function(t){var e=this.get("container"),i=e.one('.step-container[data-step-index="'+this.activeStep+'"]'),o=e.one('.step-container[data-step-index="'+t+'"]');clearTimeout(this.goToStepTimeout),o.removeClass("hiding-left"),o.removeClass("hiding-right"),i.removeClass("showing"),i.removeClass("showing-left"),i.removeClass("showing-right"),o.removeClass("hidden"),o.addClass("showing"),t>this.activeStep?(i.addClass("hiding-left"),setTimeout((function(){o.addClass("showing-left")}),0)):(i.addClass("hiding-right"),setTimeout((function(){o.addClass("showing-right")}),0)),this.goToStepTimeout=setTimeout((function(){i.removeClass("hiding-left"),i.removeClass("hiding-right"),o.removeClass("showing"),o.removeClass("showing-left"),o.removeClass("showing-right"),i.addClass("hidden")}),300),this.setStepValues(t),1===this.activeStep&&this.titleNode.focus(),this.fire("contentSizeChanged")},setStepValues:function(t){var e=this;this.headTitleNode.addClass("changing"),this.actionContainer.addClass("changing"),e.setStepValuesTimeout=setTimeout((function(){e.headTitleNode.set("innerHTML",e.labelList[t].title),e.cancelButton.set("text",e.labelList[t].cancelText),e.actionButton.set("text",e.labelList[t].actionText)}),300),this.setStepValuesTimeout=setTimeout((function(){e.headTitleNode.removeClass("changing"),e.actionContainer.removeClass("changing"),e.cancelButton.set("text",e.labelList[t].cancelText),e.actionButton.set("text",e.labelList[t].actionText)}),600),this.activeStep=t},createNewAndAddPhoto:function(){var e,i=this,o=this.titleNode.get("value"),n=this.descriptionNode.get("value");return e={name:o,description:n,userId:this.appContext.getViewer().nsid,privacyLevel:this.groupOptions.privacy,ageRestriction:this.groupOptions.ageRestriction,safetyLevel:this.groupOptions.safety},this.appContext.getModelRegistry("group-info-models").then((function(t){return i.groupInfoModelRegistry=t,t.remote.create(e,i.appContext)})).then((function(e){return i.photoId?i.addPhoto(e.id,i.photoId).then((function(){return e})):t.Promise.resolve(e)})).catch((function(t){throw t}))},addPhoto:function(t,e){var o=this;return this.appContext.getModel("group-pool-models",t).then((function(t){return o.photoModel.getValue("isOwner")?o.addToGroup(t,e):o.inviteToGroup(t,e)})).catch((function(t){i.error("Error adding photo after group creation",{err:t})}))},addToGroup:function(e,o){var n=e.getValue("id");return e.addPhotoRemote(o).catch((function(s){if(6===s.code){if(this.pendingGroupRegistry.addOrUpdate({id:[o,n].join("-"),photoId:o,groupId:n}),t.Snowplough){var r={id:n},a=[];a=a.concat(t.Snowplough.getGroupContext(r)),this.appContext.getModel("photo-models",o).then(function(e){t.Snowplough.sendStructuredEvent({category:"group",action:"invite_photo"},a.concat(t.Snowplough.getPhotoContextFromModel(e)))}.bind(this))}return e}throw i.error("Error adding photo to group",{err:s}),s}))},inviteToGroup:function(t,e){t.getValue("id");return t.invitePhotoRemote(e).catch((function(e){if(6===e.code)return t;throw i.error("Error inviting photo to group",{err:e}),e}))},showError:function(e,i,o){o&&e.set("text",t.StringHelper.preventOrphans(o)),i?e.removeClass("hidden"):e.addClass("hidden")},resetView:function(){this.buildContainer(),this.activate()}})}),"@VERSION@",{requires:["flickr-view","stuff-creation-view","hermes-template-group-creation-view","string-helper","group-guidelines"],optionalRequires:["hermes-core"],langBundles:["common","global-nav","stats","groups","add-to-stuff"]});YUI.add("curation-helper",(function(e,i){require("hermes-core/flog")(i),e.mix({langBundles:["prints"]},e.Localizable);e.CurationHelper=function(i,o){var t=this,r=o.view;return this.showAddToCuration=function(o){let s,a,n=o.photoId,l=o.customConfig,u=o.anchorNode,d=void 0===o.useViewportType||o.useViewportType,c=o.containerType,h=void 0===o.showAlbums||o.showAlbums,p=void 0!==o.showGalleries&&o.showGalleries,w=void 0===o.showGroups||o.showGroups,m=o.initialTab,v={},f=o.modalSizeConfig||void 0;return m||(m=h?"album":"gallery"),s=l||{photoId:n,initialTab:m,showAlbums:h,showGalleries:p,showGroups:w,inlineGroupCreation:!1,dismissOnSelect:!0,dismissOnCreate:!0,modalSizeConfig:f},s=Object.assign(s,{appContext:i}),v={useViewportType:d,containerType:c,configs:{droparound:{preferTop:!0,width:400,anchorElement:u,keyboardAnchorElement:u,theme:o.theme},modal:{flexLayout:!0,height:450,theme:o.theme}}},a=new e.ModalDroparoundHelper(i,v),"droparound"===a.params.containerType||(s.inlineGroupCreation=!0,s.useLargeLayout=!0,s.dismissOnSelect=!1,s.dismissOnCreate=!1),this.curateView=new e.Views["add-to-stuff-view"](s),v.configs.common.subview=this.curateView,a.setParams(v),this.curateWrapperView=a.show(),r.registerEventHandler(a.on("close",(function(e){t.fire("curateDroparoundClosed")}))),this.curateWrapperView},this.showCreationModal=function(o){var t=o.viewName,s=o.customConfig,a=o.overlayClassList,n={appContext:i};n=Object.assign(n,s),this.creationView=new e.Views[t](n),this.creationModal=new e.Views.FluidModal({appContext:i,subview:this.creationView,overlayClassList:a,dismissOnOverlayClick:!1,dismissOnEsc:!1,hasSubviewConfigRefactor:!0}),this.creationModal.show(),r.registerEventHandler(this.creationModal.on("activated",(e=>{this.creationView.focusInitial()})))},this},e.augment(e.CurationHelper,e.EventTarget)}),"@VERSION@",{requires:["event-custom","add-to-stuff-view","album-creation-view","gallery-creation-view","group-creation-view","modal-droparound-helper"],optionalRequires:["hermes-core"]});YUI.add("photo-card-engagement-view",(function(e,t){var n=require("hermes-core/flog")(t);e.namespace("Views")[this.name]=e.Base.create("photo-card-engagement-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.set("isActiveViewAgnostic",!0),this.signedIn=this.appContext.getViewer().signedIn,this.params=t,this.config={displayCurate:!("displayCurate"in t)||t.displayCurate,displayShare:"displayShare"in t&&t.displayShare,photoItem:t.photoItem,theme:t.theme,enableFaveKey:t.enableFaveKey},this.config.displayCurate=this.config.displayCurate&&this.signedIn,t.subviewParams={"like-engagement-item-view":{photoId:t.photoItem.photoId,showCount:!0,size:"small",isPadded:!1,theme:"overlay"===this.config.theme?"light":void 0},"fluid-share-photo-view":{photoId:t.photoItem.photoId,nsid:t.photoItem.owner.nsid,size:"small",theme:"light"}},this.curationHelper=new e.CurationHelper(this.appContext,{view:this})},subviewConfig:{"like-engagement-item-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["engagement-item","like"],disabled:function(){return!this.appContext.flipper.isFlipped("enable-likes")}},"fluid-share-photo-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["engagement-item","share"]}},buildContainer:function(){this.setContainerWithTemplate("photo-card-engagement",this.config)},activate:function(){var e=this.get("container");this.faveNode=e.one(".engagement-item.fave"),this.commentNode=e.one(".engagement-item.comment"),this.curateNode=e.one(".engagement-item.curate"),this.faveNode&&(this.faveCountNode=this.faveNode.one(".engagement-count"),this.registerEventHandler(this.faveNode.on(["click","key"],this.handleFaveClick.bind(this),"down:13")),this.config.enableFaveKey&&(this.keyEventHandler=this.attachKeyEvent("down:70",this.handleFaveKeyPress.bind(this)))),this.commentNode&&(this.commentIcon=this.commentNode.one(".engagement-icon"),this.commentCountNode=this.commentNode.one(".engagement-count"),this.registerEventHandler(this.commentNode.on(["click","key"],this.handleCommentClick.bind(this),"down:13"))),this.curateNode&&this.registerEventHandler(this.curateNode.on(["click","key"],this.handleCurateClick.bind(this),"down:13")),this.commentCountNode&&this.config.photoItem.engagementModel.on("valuesChanged",(e=>{if(e.commentCount){var t=e.commentCount.newVal;this.commentCountNode.set("text",e.commentCount.newVal),this.commentCountNode.toggleClass("empty",0===t)}}))},handleFaveKeyPress:function(e){70===e.keyCode&&this.handleFaveClick(e)},handleFaveClick:function(t){var i,o=this,s=this.faveNode,a=this.faveCountNode;this.faveNode.hasClass("can-not-fave")||(this.signedIn?this.isFaving||(this.isFaving=!0,this.config.photoItem.engagementModel.toggleFave(),i=this.config.photoItem.engagementModel.getValue("faveCount"),s.toggleClass("faved",this.config.photoItem.engagementModel.getValue("isFaved")),a.toggleClass("empty",0===i),a&&i>0?a.set("text",i):a.set("text",""),this.config.photoItem.engagementModel.remoteUpdate().then((function(){o.isFaving=!1}),(function(e){3!==e.code&&(o.config.photoItem.engagementModel.toggleFave(),s.toggleClass("faved",o.config.photoItem.engagementModel.getValue("isFaved")),a&&(a.set("text",i),a.toggleClass("empty",0===i))),n.error("Error faving photo",{err:e}),o.isFaving=!1}))):this.showSignUpAndFaveModal(this.config.photoItem.photoId,e.config.win.location.href))},handleCommentClick:function(){var t=this,n={appContext:this.appContext,photoId:this.config.photoItem.photoId,isScrollable:!0},i=this.config.photoItem.engagementModel.getValue("commentCount");if(this.signedIn||0!==i){var o=new e.ModalDroparoundHelper(this.appContext,{configs:{common:{subviewName:"photo-comments-view"},droparound:{subviewParams:n,preferTop:!0,width:400,height:400,anchorElement:this.commentIcon,keyboardAnchorElement:this.commentNode},modal:{subviewParams:Object.assign({},n,{hasHeader:!0}),height:550,flexLayout:!0}}});o.show(),t.registerEventHandler(e.on("addComment:showingSignupModal",(function(){o.close()}))),t.registerEventHandler(o.on("close",(function(){t.commentNode.removeClass("active"),t.fire("menuClosed")}))),this.commentNode.addClass("active"),this.fire("menuOpened")}else this.showSignUpAndCommentModal()},handleCurateClick:function(){var e=this,t=this.config.photoItem.isOwner;"fluid-droparound-view"===this.curationHelper.showAddToCuration({photoId:this.config.photoItem.photoId,showAlbums:t,showGalleries:!t,anchorNode:this.curateNode}).name&&(this.fire("menuOpened"),this.curationHelper.on("curateDroparoundClosed",(function(){e.fire("menuClosed"),e.curateNode.removeClass("active")})),this.curateNode.addClass("active"))},showSignUpAndFaveModal:function(t,n){var i,o=this.intlMessage({intlName:"fave-view.SIGN_IN_BEFORE_FAVE_TITLE"}),s=this.intlMessage({intlName:"fave-view.JOIN_FLICKR_AND_FAVE"});i=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-fave",signUpTitle:o,signUpMessage:s,beaconPrefix:"fave"}),this.registerEventHandler(i.on("signUpClick",(function(i){e.SigninHelper.signUpPendingFave({id:t},{postLoginUrl:n})}))),this.registerEventHandler(i.on("signInClick",(function(i){e.SigninHelper.addPendingFave({id:t},{postLoginUrl:n})}))),i.show()},showSignUpAndCommentModal:function(){var t,n=e.config.win.location.href,i=this.intlMessage({intlName:"photo-page-scrappy.SIGNUP_AND_COMMENT_TITLE"}),o=this.intlMessage({intlName:"photo-page-scrappy.SIGNUP_AND_COMMENT_MESSAGE"});(t=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-upload",signUpTitle:i,signUpMessage:o,beaconPrefix:"addComment"})).on("signUpClick",(()=>{e.SigninHelper._redirectToSignUp("",{postLoginUrl:n})})),t.on("signInClick",(()=>{e.SigninHelper._redirectToSignin("",{postLoginUrl:n})})),t.show()},toggleCommentNode:function(e){this.commentNode&&this.commentNode.toggleClass("hidden",!e)},toggleFaveNode:function(e){this.faveNode&&this.faveNode.toggleClass("hidden",!e)}})}),"@VERSION@",{requires:["flickr-view","photo-comments-view","fluid-share-photo-view","hermes-template-photo-card-engagement","curation-helper","modal-droparound-helper"],optionalRequires:["hermes-core"],langBundles:["common","comments","fave-view","photo-page-scrappy"]});YUI.add("hermes-lang-fave-view",(function(e,t){e.Intl.add("hermes/fave-view","en-US",{COULDNT_FAVE:[{type:0,value:"We couldn’t fave at this time"}],SIGN_IN_TO_FAVE:[{type:0,value:"You must be signed in to fave. Please sign in now."}],LOADING_FAVES:[{type:0,value:"Loading Faves..."}],UNFAVE_PHOTO:[{type:0,value:"Unfave this photo"}],FAVE_PHOTO:[{type:0,value:"Fave this photo"}],WHO_FAVED:[{type:0,value:"Who faved this photo"}],SIGN_IN_BEFORE_FAVE_TITLE:[{type:0,value:"You found a photo to fave!"}],SIGN_IN_BEFORE_FAVE_MESSAGE:[{type:0,value:"That’s great. Just sign in to fave it."}],SIGN_IN_AND_FAVE:[{type:0,value:"Sign in and fave"}],JOIN_FLICKR_AND_FAVE:[{type:0,value:"Join Flickr to add this photo to your favorites."}]})}),"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-photo-card-header",(function(n,t){var l=n.Template.Handlebars.revive({1:function(n,t,l,e,o){return" compact"},3:function(n,t,l,e,o){return" theme-overlay"},5:function(n,t,l,e,o){var a,r,i=null!=t?t:n.nullContext||{},u=n.hooks.helperMissing,s="function",c=n.escapeExpression,p=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t<a\n\t\t\t\tclass="avatar no-refresh\n\t\t\t\t\t'+(null!=(a=p(l,"if").call(i,null!=t?p(t,"isCompact"):t,{name:"if",hash:{},fn:n.program(6,o,0),inverse:n.program(8,o,0),data:o,loc:{start:{line:8,column:5},end:{line:8,column:52}}}))?a:"")+"\n\t\t\t\t\t"+(null!=(a=p(l,"if").call(i,null!=t?p(t,"isPersonAttribution"):t,{name:"if",hash:{},fn:n.program(10,o,0),inverse:n.noop,data:o,loc:{start:{line:9,column:5},end:{line:9,column:46}}}))?a:"")+"\n\t\t\t\t\t"+(null!=(a=p(l,"if").call(i,null!=t?p(t,"isGroupAttribution"):t,{name:"if",hash:{},fn:n.program(12,o,0),inverse:n.noop,data:o,loc:{start:{line:10,column:5},end:{line:10,column:44}}}))?a:"")+'"\n\t\t\t\tstyle="background-image: url('+c(typeof(r=null!=(r=p(l,"iconUrl")||(null!=t?p(t,"iconUrl"):t))?r:u)===s?r.call(i,{name:"iconUrl",hash:{},data:o,loc:{start:{line:11,column:33},end:{line:11,column:44}}}):r)+');"\n\t\t\t\thref="'+c(typeof(r=null!=(r=p(l,"url")||(null!=t?p(t,"url"):t))?r:u)===s?r.call(i,{name:"url",hash:{},data:o,loc:{start:{line:12,column:10},end:{line:12,column:17}}}):r)+'"\n\t\t\t\t'+(null!=(a=p(l,"if").call(i,null!=t?p(t,"isPersonAttribution"):t,{name:"if",hash:{},fn:n.program(14,o,0),inverse:n.noop,data:o,loc:{start:{line:13,column:4},end:{line:13,column:74}}}))?a:"")+"\n\t\t\t\t"+(null!=(a=p(l,"if").call(i,null!=t?p(t,"isGroupAttribution"):t,{name:"if",hash:{},fn:n.program(16,o,0),inverse:n.noop,data:o,loc:{start:{line:14,column:4},end:{line:14,column:72}}}))?a:"")+"></a>\n"},6:function(n,t,l,e,o){return" very-tiny"},8:function(n,t,l,e,o){return" tiny"},10:function(n,t,l,e,o){return" person"},12:function(n,t,l,e,o){return" group"},14:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'data-person-nsid="'+n.escapeExpression("function"==typeof(a=null!=(a=r(l,"attributionId")||(null!=t?r(t,"attributionId"):t))?a:n.hooks.helperMissing)?a.call(null!=t?t:n.nullContext||{},{name:"attributionId",hash:{},data:o,loc:{start:{line:13,column:49},end:{line:13,column:66}}}):a)+'"'},16:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'data-group-nsid="'+n.escapeExpression("function"==typeof(a=null!=(a=r(l,"attributionId")||(null!=t?r(t,"attributionId"):t))?a:n.hooks.helperMissing)?a.call(null!=t?t:n.nullContext||{},{name:"attributionId",hash:{},data:o,loc:{start:{line:14,column:47},end:{line:14,column:64}}}):a)+'"'},18:function(n,t,l,e,o){var a,r,i=null!=t?t:n.nullContext||{},u=n.hooks.helperMissing,s="function",c=n.escapeExpression,p=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t<div class="title-container">\n\t\t\t\t\t<a class="title" href="'+c(typeof(r=null!=(r=p(l,"url")||(null!=t?p(t,"url"):t))?r:u)===s?r.call(i,{name:"url",hash:{},data:o,loc:{start:{line:19,column:28},end:{line:19,column:35}}}):r)+'">'+c(typeof(r=null!=(r=p(l,"title")||(null!=t?p(t,"title"):t))?r:u)===s?r.call(i,{name:"title",hash:{},data:o,loc:{start:{line:19,column:37},end:{line:19,column:46}}}):r)+"</a>\n"+(null!=(a=p(l,"if").call(i,null!=t?p(t,"showProBadge"):t,{name:"if",hash:{},fn:n.program(19,o,0),inverse:n.noop,data:o,loc:{start:{line:20,column:5},end:{line:26,column:12}}}))?a:"")+"\t\t\t\t</div>\n"},19:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(a=(r(l,"ifCond")||t&&r(t,"ifCond")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},null!=t?r(t,"theme"):t,"===","overlay",{name:"ifCond",hash:{},fn:n.program(20,o,0),inverse:n.program(22,o,0),data:o,loc:{start:{line:21,column:6},end:{line:25,column:17}}}))?a:""},20:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(a=n.invokePartial(r(e,"pro-badge"),t,{name:"pro-badge",hash:{purchaseProURL:null!=t?r(t,"purchaseProURL"):t,light:!0,badgeType:null!=t?r(t,"proBadgeType"):t},data:o,indent:"\t\t\t\t\t\t\t",helpers:l,partials:e,decorators:n.decorators}))?a:""},22:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(a=n.invokePartial(r(e,"pro-badge"),t,{name:"pro-badge",hash:{purchaseProURL:null!=t?r(t,"purchaseProURL"):t,badgeType:null!=t?r(t,"proBadgeType"):t},data:o,indent:"\t\t\t\t\t\t\t",helpers:l,partials:e,decorators:n.decorators}))?a:""},24:function(n,t,l,e,o){var a,r=null!=t?t:n.nullContext||{},i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t<div class="card-details">\n'+(null!=(a=i(l,"if").call(r,null!=t?i(t,"activityName"):t,{name:"if",hash:{},fn:n.program(25,o,0),inverse:n.noop,data:o,loc:{start:{line:32,column:5},end:{line:35,column:12}}}))?a:"")+'\t\t\t\t\t<span class="time">\n\t\t\t\t\t\t'+(null!=(a=(i(l,"friendlySinceDate")||t&&i(t,"friendlySinceDate")||n.hooks.helperMissing).call(r,null!=t?i(t,"time"):t,!0,!0,{name:"friendlySinceDate",hash:{},fn:n.program(27,o,0),inverse:n.noop,data:o,loc:{start:{line:37,column:6},end:{line:37,column:108}}}))?a:"")+"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n"},25:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t\t<span class="activity-type">'+n.escapeExpression("function"==typeof(a=null!=(a=r(l,"activityName")||(null!=t?r(t,"activityName"):t))?a:n.hooks.helperMissing)?a.call(null!=t?t:n.nullContext||{},{name:"activityName",hash:{},data:o,loc:{start:{line:33,column:34},end:{line:33,column:50}}}):a)+'</span>\n\t\t\t\t\t\t<span class="separator">&middot;</span>\n'},27:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return n.escapeExpression((a(l,"intlMessage")||t&&a(t,"intlMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlMessage",hash:{time:null!=t?a(t,"time"):t,intlName:null!=t?a(t,"intlName"):t},data:o,loc:{start:{line:37,column:43},end:{line:37,column:86}}}))},29:function(n,t,l,e,o){return'\t\t\t<div role="button" class="menu-button">\n\t\t\t\t<svg class="icon icon-more_horizontal"><use xlink:href="#icon-more_horizontal"></use></svg>\n\t\t\t</div>\n'},compiler:[8,">= 4.3.0"],main:function(n,t,l,e,o){var a,r=null!=t?t:n.nullContext||{},i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'<div class="photo-card-header\n\t'+(null!=(a=i(l,"if").call(r,null!=t?i(t,"isCompact"):t,{name:"if",hash:{},fn:n.program(1,o,0),inverse:n.noop,data:o,loc:{start:{line:2,column:1},end:{line:2,column:33}}}))?a:"")+"\n\t"+(null!=(a=(i(l,"ifCond")||t&&i(t,"ifCond")||n.hooks.helperMissing).call(r,null!=t?i(t,"theme"):t,"===","overlay",{name:"ifCond",hash:{},fn:n.program(3,o,0),inverse:n.noop,data:o,loc:{start:{line:3,column:1},end:{line:3,column:59}}}))?a:"")+'">\n\t<div class="left-container">\n'+(null!=(a=i(l,"if").call(r,null!=t?i(t,"iconUrl"):t,{name:"if",hash:{},fn:n.program(5,o,0),inverse:n.noop,data:o,loc:{start:{line:5,column:2},end:{line:15,column:9}}}))?a:"")+'\t\t<div class="attribution">\n'+(null!=(a=i(l,"if").call(r,null!=t?i(t,"title"):t,{name:"if",hash:{},fn:n.program(18,o,0),inverse:n.noop,data:o,loc:{start:{line:17,column:3},end:{line:28,column:10}}}))?a:"")+"\n"+(null!=(a=i(l,"if").call(r,null!=t?i(t,"showDetails"):t,{name:"if",hash:{},fn:n.program(24,o,0),inverse:n.noop,data:o,loc:{start:{line:30,column:3},end:{line:40,column:10}}}))?a:"")+'\t\t</div>\n\t</div>\n\t<div class="right-container">\n'+(null!=(a=i(l,"if").call(r,null!=t?i(t,"showMenu"):t,{name:"if",hash:{},fn:n.program(29,o,0),inverse:n.noop,data:o,loc:{start:{line:44,column:2},end:{line:48,column:9}}}))?a:"")+"\t</div>\n</div>\n"},usePartial:!0,useData:!0}),e={};n.Array.each(["pro-badge","pro-badge"],(function(t){var l=n.Template.get("hermes/"+t);l&&(e[t]=l)})),n.Template.register("hermes/photo-card-header",(function(t,o){return(o=o||{}).partials=o.partials?n.merge(e,o.partials):e,l(t,o)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-pro-badge","hermes-template-pro-badge"]});YUI.add("fluid-share-photostream-view",(function(e,t){e.FlickrView.create(this.name,e.namespace("Views")["fluid-share-view"],[],{langBundles:this.details.langBundles,subClassName:t,initializer:function(e){return this.nsid=e.nsid,this.constructor.superclass.buildContainer.call(this,{extraShareButtonClassList:"share-photostream-icon",sharingDisabled:!0,shareTooltip:this.intlMessage({intlName:"share-modal.SHARE_PHOTOSTREAM"})}),this.constructor.superclass.initializer.call(this,e)},loadState:function(){return this.isEnglishLang?e.Promise.resolve():this.loadRequiredModels()},getItemCount:function(){return this.isEnglishLang?this.loadRequiredModels():e.Promise.resolve(1)},loadRequiredModels:function(){var t=this;return e.Promise.all([this.appContext.getModel("photostream-models",this.nsid+"-1",{privacyFilter:1,perPage:5,page:1}),this.appContext.getModelRegistry("photostream-models")]).then((function(e){t.set("photostreamModel",e[0]),t.isDisabled=t.appContext.getViewer().nsid!==t.nsid&&parseInt(e[0].getValue("totalItems"),10)<1,t.set("photos",e[0].getValue("photoPageList").getList()),t.appContext.getViewer().nsid===t.nsid&&e[1].exists(t.nsid)&&(t.isDisabled=t.isDisabled||parseInt(e[1].getValue(t.nsid,"totalItems"),10)<1)}))},buildContainer:function(){return this.constructor.superclass.buildContainer.call(this,{extraShareButtonClassList:"share-photostream-icon",sharingDisabled:this.isDisabled,shareTooltip:this.intlMessage({intlName:"share-modal.SHARE_PHOTOSTREAM"})}),this},prepareFacebookShareParameters:function(){return{url:this.get("photostreamModel").getValue("url")}},prepareTwitterShareParameters:function(){var t=this.get("photostreamModel");return{url:e.URLHelper.getShortPhotostreamURL(t.getValue("normalizedId")),title:this.intlMessage({intlName:"models.USER_PHOTOSTREAM",name:t.getValue("owner").getValue("displayname")})}},prepareTumblrShareParameters:function(){var e=this.get("photostreamModel"),t=e.getValue("owner");return{title:this.intlMessage({intlName:"models.USER_PHOTOSTREAM",name:t.getValue("displayname")}),authorURL:t.getValue("url"),url:e.getValue("url"),displayPhotoURL:this.get("photos").map((function(e){return e.getLargestSize().url})),tags:"Flickr"}},preparePinterestShareParameters:function(){var t=this.get("photostreamModel"),s=t.getValue("owner");return{title:this.intlMessage({intlName:"models.USER_PHOTOSTREAM",name:s.getValue("displayname")}),displayPhotoURL:this.get("photos").length>0?this.get("photos")[0].getLargestSize().url:null,shortURL:e.URLHelper.getShortPhotostreamURL(t.getValue("normalizedId")),url:t.getValue("url"),count:1}},prepareFlickrShareParameters:function(){var e=this.get("photostreamModel"),t=e.getValue("owner");return{title:this.intlMessage({intlName:"models.USER_PHOTOSTREAM",name:t.getValue("displayname")}),modelName:"photostream",modelId:this.nsid,url:e.getValue("url"),count:1}},prepareLinkShareParameters:function(){var t=this.get("photostreamModel"),s=this.get("photos");return{url:t.getValue("url"),author:t.getValue("owner").getValue("displayname"),authorURL:t.getValue("owner").getValue("url"),shortURL:e.URLHelper.getShortPhotostreamURL(t.getValue("normalizedId")),embedUrl:"/photos/"+t.getValue("normalizedId"),supportsEmbedr:!0,sizes:s.length>0?e.EmbedSizeHelper.getSizes(s[0]):void 0,userId:t.getValue("normalizedId"),privacyWarningString:this.intlMessage({intlName:"share-modal.PHOTOSTREAM_PRIVACY_WARNING",photoCount:t.getValue("totalItems")})}},getTitleIntlKey:function(){return"SHARE_PHOTOSTREAM_TO"},getGuestPassParams:function(){var e=this.appContext.getViewer().nsid;return{type:"photostream",id:this.nsid,contentMarkedFriends:this.nsid===e,contentMarkedFamily:this.nsid===e,contentMarkedFriendFamily:this.nsid===e,contentMarkedPublic:!0,canSharePrivate:!1,showGuestPassDropdown:!0,shareToAll:!0,multipleItems:!0}},getIsMine:function(){return this.get("photostreamModel").getValue("isOwner")}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-share-view","url-helper"],langBundles:["models"]});YUI.add("embed-size-helper",(function(h){h.EmbedSizeHelper={getSizes:function(h){var i={n:{width:320,height:240},w:{width:400,height:300},m:{width:500,height:375},z:{width:640,height:480},c:{width:800,height:600},l:{width:1024,height:768},h:{width:1600,height:1200},np:{width:240,height:320},wp:{width:300,height:400},mp:{width:375,height:500},zp:{width:480,height:640},cp:{width:600,height:800},lp:{width:768,height:1024},hp:{width:1200,height:1600}};return Object.keys(i).map((function(t){i[t].url=h.getSizeToFit({width:i[t].width,height:i[t].height}).url})),i}}}),"@VERSION@");