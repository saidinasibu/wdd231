YUI.add("getty-widget-view",(function(t,e){var i=new t.SubscriptionsHelper,s=require("justified-layout"),o=require("hermes-core/flog")(e);t.namespace("Views")["getty-widget-view"]=t.Base.create("getty-widget-view",t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){this.justifiedLayout=s,this.params=e,this.isMobile=this.params.isMobile,this.widgetType=this.params.type,this.widgetInPhotoList=this.params.inPhotolist,this.searchTerm=this.getSearchTerm(),this.geo=this.params.geo;var i=this.appContext.viewportData.getWidth(),o=t.config.flickr.moola.ad_breakpoint_mobile_desktop,a=this.appContext.flipper.isFlipped("enable-dark-photopage-with-sidebar")&&i>=o;this.iStockLogoLocation=a?t.config.flickr.urls.assetRoot+"/images/getty/IStock_corporate_logo_white.svg":t.config.flickr.urls.assetRoot+"/images/getty/IStock_corporate_logo.svg",this.currentUrl=YUI.Env.isServer?this.appContext.request.url:t.url()+this.appContext.flapp.getPath(),this.countryCode=null,this.widgetIsInView=!1,this.widgetIsLoaded=!1,this.widgetLoadEventListener,this.bottom,this.apiFailed,this.randomClasses=YUI.Env.isServer?this.appContext.request.randomClasses:t.config.flickr.randomClasses,this.resizeThrottle=300,this.gettyWidgetId,this.gettyImages,this.gettyFlickrDiscountCode=this.intlHTMLMessage({intlName:"common.GETTY_FLICKR_20_DISCOUNT"}),this.params.photoId&&this.appContext.gettyHelper.setPreviousPhotoId(this.params.photoId),this.types={searchPage:{searchTerm:this.searchTerm,layoutSpacing:4,layoutRowHeight:140,layoutRowHeightTolerance:0,layoutMaxAr:2,snowPlowLabel:"getty-search",rowCount:1,typeClass:"search-page",viewMoreFlipper:"enable-getty-view-more-search",utmOptions:{promo:{campaign:this.widgetInPhotoList?`srp_photos_${this.getPositionalTag()}`:"srp_photos_top",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:"https://www.istockphoto.com/plans-and-pricing"},viewMore:{campaign:"srp_photos_viewmore",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:"https://www.istockphoto.com/search/2/image",extraParams:`?mediatype=photography&phrase=${this.searchTerm}`},imageAsset:{campaign:this.widgetInPhotoList?`srp_photos_${this.getPositionalTag()}`:"srp_photos_top",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:""}}},photoPage:{searchTerm:"adventure",layoutSpacing:4,layoutRowHeight:this.params.sidebar?100:120,layoutRowHeightTolerance:0,layoutMaxAr:2,snowPlowLabel:"getty-photopage",layoutContainerWidth:this.params.sidebar?300:500,rowCount:2,typeClass:"photo-page",viewMoreFlipper:"enable-getty-view-more-photo",utmOptions:{promo:{campaign:"adp_photos_sponsored",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:"https://www.istockphoto.com/plans-and-pricing"},viewMore:{campaign:"adp_photos_viewmore",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:"https://www.istockphoto.com/search/2/image",extraParams:""},imageAsset:{campaign:"adp_photos_sponsored",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:""}}},trendTagsPage:{searchTerm:"nature",layoutSpacing:4,layoutRowHeight:200,layoutRowHeightTolerance:0,layoutMaxAr:1,snowPlowLabel:"getty-trend-tags-page",rowCount:1,typeClass:"default-widget-page",viewMoreFlipper:"enable-getty-view-more-search",utmOptions:{promo:{campaign:"Trending_photos_sponsored",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:"https://www.istockphoto.com/plans-and-pricing"},viewMore:{campaign:"Trending_photos_viewmore",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:"https://www.istockphoto.com/search/2/image",extraParams:`?mediatype=photography&phrase=${this.searchTerm}`},imageAsset:{campaign:"Trending_photos_sponsored",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:""}}},explorePage:{searchTerm:"nature",layoutSpacing:4,layoutRowHeight:200,layoutRowHeightTolerance:0,layoutMaxAr:1,snowPlowLabel:"getty-explore-page",rowCount:1,typeClass:"default-widget-page",viewMoreFlipper:"enable-getty-view-more-search",utmOptions:{promo:{campaign:"Explore_photos_sponsored",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:"https://www.istockphoto.com/plans-and-pricing"},viewMore:{campaign:"Explore_photos_viewmore",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:"https://www.istockphoto.com/search/2/image",extraParams:`?mediatype=photography&phrase=${this.searchTerm}`},imageAsset:{campaign:"Explore_photos_sponsored",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:""}}},tagsPage:{searchTerm:this.searchTerm,layoutSpacing:4,layoutRowHeight:200,layoutRowHeightTolerance:0,layoutMaxAr:1,snowPlowLabel:"getty-tags-page",rowCount:1,typeClass:"default-widget-page",viewMoreFlipper:"enable-getty-view-more-search",utmOptions:{promo:{campaign:"Tags_photos_sponsored",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:"https://www.istockphoto.com/plans-and-pricing"},viewMore:{campaign:"Tags_photos_viewmore",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:"https://www.istockphoto.com/search/2/image",extraParams:`?mediatype=photography&phrase=${this.searchTerm}`},imageAsset:{campaign:"Tags_photos_sponsored",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:""}}},interstitial:{searchTerm:this.searchTerm,layoutSpacing:4,layoutRowHeight:140,layoutRowHeightTolerance:0,layoutMaxAr:2,snowPlowLabel:"getty-interstitial",rowCount:1,typeClass:"photo-page",viewMoreFlipper:"enable-getty-view-more-search",utmOptions:{promo:{campaign:this.widgetInPhotoList?`srp_photos_${this.getPositionalTag()}`:"srp_photos_top",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:"https://www.istockphoto.com/plans-and-pricing"},viewMore:{campaign:"srp_photos_viewmore",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:"https://www.istockphoto.com/search/2/image",extraParams:`?mediatype=photography&phrase=${this.searchTerm}`},imageAsset:{campaign:this.widgetInPhotoList?`srp_photos_${this.getPositionalTag()}`:"srp_photos_top",term:this.searchTerm,pageUrl:this.currentUrl,originalURL:""}}}},this.utmTrackingOptions=this.getUtmOptions(),this.params.geo&&this.params.geo.countryCode?this.countryCode=this.params.geo.countryCode:t.config.flickr.geo&&t.config.flickr.geo.countryCode&&(this.countryCode=t.config.flickr.geo.countryCode),this.params.sidebar&&this.appContext.adManager.userCanViewPhotoPageSidebar()&&(this.widgetIsInView=!0,this.widgetIsLoaded=!0)},getSearchTerm:function(){return"searchPage"===this.widgetType?this.params.searchTerm:"photoPage"===this.widgetType||"interstitial"===this.widgetType?this.appContext.gettyHelper.widgetDefaultSearchTerm:"trendTagsPage"===this.widgetType||"explorePage"===this.widgetType?"nature":"tagsPage"===this.widgetType?this.params.tag:void 0},getUtmOptions:function(){return this.types[this.widgetType].utmOptions},getPhotoPageState:function(){if(!YUI.Env.isServer&&this.widgetIsInView&&this.appContext.adManager.canShowAdWithPhoto(this.photoModel)){var e=this;let i={photoId:e.params.photoId,language:e.appContext.gettyHelper.getCorrectLangFormat(),countryCode:e.countryCode};return e.appContext.getModel("getty-search-models",i).then((e=>(this.gettyModel=e,this.apiFailed=!1,this.updateSearchTerm(),t.Snowplough&&t.Snowplough.sendStructuredEvent({category:this.searchTerm,action:"gettyResultsLoad",label:this.types[this.widgetType].snowPlowLabel}),{registryName:"getty-search-models",modelId:e.id}))).catch((i=>{e.apiFailed=!0,t.Snowplough&&t.Snowplough.sendStructuredEvent({category:e.searchTerm,action:"gettyResultsFail",label:this.types[this.widgetType].snowPlowLabel}),o.error("Error with fetching getty-search-models",{err:i})}))}return t.Promise.resolve()},updateSearchTerm:function(){this.searchTerm=this.gettyModel.getValue("searchPhrase"),this.utmTrackingOptions.promo.term=this.searchTerm,this.utmTrackingOptions.imageAsset.term=this.searchTerm,this.utmTrackingOptions.viewMore.term=this.searchTerm,this.utmTrackingOptions.viewMore.extraParams=`?mediatype=photography&phrase=${this.searchTerm}`},getSearchState:function(){let e={searchTerm:this.searchTerm,color:this.appContext.gettyHelper.getSearchColorHex(this.params),orientations:this.appContext.gettyHelper.getSearchOrientation(this.params),language:this.appContext.gettyHelper.getCorrectLangFormat(),countryCode:this.countryCode,pageSize:50};return this.appContext.getModel("getty-search-models",e).then((e=>(this.gettyModel=e,this.apiFailed=!1,this.updateSearchTerm(),t.Snowplough&&t.Snowplough.sendStructuredEvent({category:this.searchTerm,action:"gettyResultsLoad",label:this.types[this.widgetType].snowPlowLabel}),{registryName:"getty-search-models",modelId:e.id}))).catch((e=>{this.apiFailed=!0,t.Snowplough&&t.Snowplough.sendStructuredEvent({category:this.searchTerm,action:"gettyResultsFail",label:this.types[this.widgetType].snowPlowLabel}),o.error("Error with fetching getty-search-models",{err:e})}))},getDefaultWidgetState:function(){let e={searchTerm:this.searchTerm,language:this.appContext.gettyHelper.getCorrectLangFormat(),countryCode:this.countryCode};return this.appContext.getModel("getty-search-models",e).then((e=>(this.gettyModel=e,this.apiFailed=!1,t.Snowplough&&t.Snowplough.sendStructuredEvent({category:this.params.searchTerm,action:"gettyResultsLoad",label:this.types[this.widgetType].snowPlowLabel}),{registryName:"getty-search-models",modelId:e.id}))).catch((e=>{this.apiFailed=!0,t.Snowplough&&t.Snowplough.sendStructuredEvent({category:this.params.searchTerm,action:"gettyResultsFail",label:this.types[this.widgetType].snowPlowLabel}),o.error("Error with fetching getty-search-models",{err:e})}))},getInterstitialtWidgetState:function(){var e=this;let i={};return i=this.appContext.gettyHelper.previousPhotoId&&this.appContext.adManager.canShowAdWithPhoto(this.photoModel)?{photoId:e.appContext.gettyHelper.previousPhotoId,language:e.appContext.gettyHelper.getCorrectLangFormat(),countryCode:e.countryCode,pageSize:50}:{searchTerm:this.searchTerm,language:this.appContext.gettyHelper.getCorrectLangFormat(),countryCode:this.countryCode,pageSize:50},e.appContext.getModel("getty-search-models",i).then((e=>(this.gettyModel=e,this.apiFailed=!1,t.Snowplough&&t.Snowplough.sendStructuredEvent({category:this.params.searchTerm,action:"gettyResultsLoad",label:this.types[this.widgetType].snowPlowLabel}),{registryName:"getty-search-models",modelId:e.id}))).catch((e=>{this.apiFailed=!0,t.Snowplough&&t.Snowplough.sendStructuredEvent({category:this.params.searchTerm,action:"gettyResultsFail",label:this.types[this.widgetType].snowPlowLabel}),o.error("Error with fetching getty-search-models",{err:e})}))},loadState:function(){let t,e,i=this,s=this.appContext.gettyHelper.previousPhotoId||this.params.photoId||null;return"searchPage"===this.widgetType?t=this.getSearchState:"photoPage"===this.widgetType?t=this.getPhotoPageState:"interstitial"===this.widgetType?t=this.getInterstitialtWidgetState:["trendTagsPage","explorePage","tagsPage"].includes(this.widgetType)&&(t=this.getDefaultWidgetState),e=s?this.appContext.getModel("photo-models",s).then((function(t){t&&(i.photoModel=t)})):Promise.resolve(),e.then((()=>t.bind(i).apply().then((t=>{t&&(i.gettyWidgetId=i.appContext.gettyHelper.cacheWidget(t.registryName,t.modelId,i.gettyModel.getValue("images"),i.params),i.gettyImages=i.appContext.gettyHelper.getWidgetById(i.gettyWidgetId).widgetImages)})))).catch((t=>{o.error("Error with fetching getty-search-models",{err:t})}))},buildLayout:function(){var t,e,i=this,s=this.gettyImages,o=0,a=0,r=0,h=this.types[this.widgetType].rowCount;if(s){if(e=this.types[this.widgetType].layoutContainerWidth?this.types[this.widgetType].layoutContainerWidth:80*this.appContext.viewportData.getWidth()/100,this.appContext.gettyHelper.isPhotopageInterstitialWidget()){let t=this.appContext.gettyHelper.getWidgetById(this.gettyWidgetId);t&&t.widgetImages&&t.widgetImages.length&&(s=this.gettyImages=this.appContext.gettyHelper.randomizeImages(t.widgetImages))}var n=s.map((function(t){return Math.min(Number(parseFloat(t.maxDimensions.width/t.maxDimensions.height).toFixed(2)),i.types[i.widgetType].layoutMaxAr)}));return"searchPage"===this.widgetType&&this.appContext.flipper.isFlipped("enable-search-sidebar")?this.appContext.viewportData.getWidth()>1080&&(e-=340):"interstitial"===this.widgetType&&(e=this.appContext.gettyHelper.getInterstitialWidget().rowWidth,i.types[i.widgetType].layoutRowHeight=this.appContext.gettyHelper.getInterstitialWidget().rowHeight,h=this.appContext.gettyHelper.getInterstitialWidget().rowCount),(t=this.getJustifiedLayout(n,e)).boxes.some((function(e,s){a<e.top&&(a=e.top,++o>=h&&(r=r||s,t.containerHeight=t.containerHeight-e.height-i.types[i.widgetType].layoutSpacing))})),r||(r=t.boxes.length),t.containerWidth=e,t.boxes=t.boxes.slice(0,r),t.boxes.forEach(((t,e)=>{var s=i.gettyImages[e],o=this.utmTrackingOptions.imageAsset;o.originalURL=s.referenceUri,t.displayUri=s.displayUri,t.url=this.appContext.gettyHelper.appendGettyTracking(o),t.gettyImageUrl=s.referenceUri,t.caption=s.caption})),t}},getJustifiedLayout:function(t,e){let i,s;return i=this.justifiedLayout(t,{containerWidth:e,containerPadding:0,forceAspectRatio:1,boxSpacing:{horizontal:this.types[this.widgetType].layoutSpacing,vertical:this.types[this.widgetType].layoutSpacing},targetRowHeight:this.types[this.widgetType].layoutRowHeight,targetRowHeightTolerance:this.types[this.widgetType].layoutRowHeightTolerance}),s=i.boxes.length*i.boxes[0].width,s<e&&e-s>this.types[this.widgetType].layoutSpacing?(this.appContext.gettyHelper.setImagesInWidget(this.gettyWidgetId,3),this.buildLayout()):i},buildContainer:function(){var t={apiFailed:this.apiFailed,iStockLogo:this.iStockLogoLocation,gettyPromoLink:this.appContext.gettyHelper.appendGettyTracking(this.utmTrackingOptions.promo),upgradeProLink:i.getProLandingPageUrl(i.UTM_HIDE_ADS_GETTY_SEARCH),typeClass:this.types[this.widgetType].typeClass,viewMoreFlipper:this.types[this.widgetType].viewMoreFlipper,randomClasses:this.randomClasses,widgetID:this.gettyWidgetId,gettyFlickrDiscountCode:this.gettyFlickrDiscountCode,shouldSeeSidebar:this.appContext.adManager.userCanViewPhotoPageSidebar()&&(this.appContext.flipper.isFlipped("enable-dark-photopage-with-sidebar")||!this.isMobile)};return["searchPage","trendTagsPage","explorePage","tagsPage","interstitial"].includes(this.widgetType)?(t.layout=this.apiFailed||YUI.Env.isServer?[]:this.buildLayout(),t.viewMoreLink=this.appContext.flipper.isFlipped("enable-getty-view-more-search")?this.appContext.gettyHelper.appendGettyTracking(this.utmTrackingOptions.viewMore):""):(t.layout=this.apiFailed||YUI.Env.isServer||!this.widgetIsInView?[]:this.buildLayout(),t.viewMoreLink=this.appContext.flipper.isFlipped("enable-getty-view-more-photo")?this.appContext.gettyHelper.appendGettyTracking(this.utmTrackingOptions.viewMore):""),this.setContainerWithTemplate("getty-widget",t),this},activate:function(){var e=this.get("container"),i=e,s=null;if(e&&"photoPage"===this.widgetType&&!this.widgetIsLoaded){for(;i&&!s;){var o=i.previous();o?s=o:i=i.get("parentNode")}s&&(this.bottom=s.getDOMNode().getBoundingClientRect().bottom),this.widgetLoadEventListener=this.registerEventHandler(t.globalEvents.subscribe("window:scroll",this.checkIfWidgetInViewport.bind(this)))}return this.buildContainer(),this.registerEventHandler(this.get("container").delegate("click",this.onGettyResultClick.bind(this),`.${this.randomClasses["getty-result"]}`)),this.registerEventHandler(this.get("container").delegate("click",this.onDiscountCodeClick.bind(this),`.${this.randomClasses["sponsor-discount-code"]}`)),this.registerEventHandler(this.get("container").delegate("click",this.onViewMoreTileClick.bind(this),`.${this.randomClasses["last-result-container"]}`)),this.registerEventHandler(t.on("resize",t.betterThrottle(this.onResize.bind(this),this.resizeThrottle,this,!0))),this.registerEventHandler(this.appContext.flapp.before("activeViewChange",this.handleViewChange.bind(this))),this},handleViewChange:function(){this.appContext.gettyHelper.clearCache(this.widgetType)},getPositionalTag:function(){return this.params.layoutItem&&this.params.layoutItem.fullRowStatic&&"photo-list-revenue-item-view"===this.params.layoutItem.name?this.params.layoutItem.siblingPosition:null},checkIfWidgetInViewport:function(){window.scrollY+window.innerHeight>=this.bottom+200&&(t.globalEvents.unsubscribe(this.widgetLoadEventListener),this.loadWidget())},loadWidget:function(){var t=this.get("container"),e=this;t&&(this.widgetIsInView=!0,this.widgetIsLoaded=!0,this.loadState().then((function(){e.buildContainer()})))},onResize:function(){this.buildContainer()},onGettyResultClick:function(e){let i=e.currentTarget;if(t.Snowplough&&i){let e=i.getAttribute("data-g-url"),s=parseInt(i.getAttribute("data-g-index"),10)+1;t.Snowplough.sendStructuredEvent({category:this.searchTerm,action:"gettyResultClick",label:this.types[this.widgetType].snowPlowLabel,property:e,value:s})}},onDiscountCodeClick:function(){t.Snowplough&&t.Snowplough.sendStructuredEvent({category:this.searchTerm,action:"gettyDiscountCodeClick",label:this.types[this.widgetType].snowPlowLabel})},onViewMoreTileClick:function(){t.Snowplough&&t.Snowplough.sendStructuredEvent({category:this.searchTerm,action:"gettyViewMoreTileClick",label:this.types[this.widgetType].snowPlowLabel})}})}),"@VERSION@",{requires:["flickr-view","hermes-template-getty-widget","getty-helper","getty-search-models"],optionalRequires:["hermes-core"],langBundles:["common"]});YUI.add("hermes-template-infinite-scroll-load-more",(function(e,a){var t=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,t,n,l){var r=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<div class="infinite-scroll-load-more">\n\t<button class="alt">'+e.escapeExpression((r(t,"intlMessage")||a&&r(a,"intlMessage")||e.hooks.helperMissing).call(null!=a?a:e.nullContext||{},{name:"intlMessage",hash:{intlName:"common.LOAD_MORE_RESULTS"},data:l,loc:{start:{line:2,column:21},end:{line:2,column:72}}}))+"</button>\n</div>"},useData:!0}),n={};e.Array.each([],(function(a){var t=e.Template.get("hermes/"+a);t&&(n[a]=t)})),e.Template.register("hermes/infinite-scroll-load-more",(function(a,l){return(l=l||{}).partials=l.partials?e.merge(n,l.partials):n,t(a,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-license-detail",(function(e,a){var l=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,l,n,t){var s=null!=a?a:e.nullContext||{},r=e.hooks.helperMissing,i=e.escapeExpression,o=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<p class="secondary" style="margin-top: 0;">'+i((o(l,"intlMessage")||a&&o(a,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:null!=a?o(a,"title"):a},data:t,loc:{start:{line:1,column:44},end:{line:1,column:74}}}))+'</p>\n<p class="secondary" style="margin-bottom: 0;">'+i((o(l,"intlMessage")||a&&o(a,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:null!=a?o(a,"body"):a},data:t,loc:{start:{line:2,column:47},end:{line:2,column:76}}}))+"</p>\n"},useData:!0}),n={};e.Array.each([],(function(a){var l=e.Template.get("hermes/"+a);l&&(n[a]=l)})),e.Template.register("hermes/license-detail",(function(a,t){return(t=t||{}).partials=t.partials?e.merge(n,t.partials):n,l(a,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-adult-content-photo-overlay",(function(n,e){var l=n.Template.Handlebars.revive({1:function(n,e,l,t,a){return" compact"},3:function(n,e,l,t,a){return" large"},5:function(n,e,l,t,a){return" with-nsfw-2024"},7:function(n,e,l,t,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"width:"+n.escapeExpression("function"==typeof(o=null!=(o=r(l,"containerWidth")||(null!=e?r(e,"containerWidth"):e))?o:n.hooks.helperMissing)?o.call(null!=e?e:n.nullContext||{},{name:"containerWidth",hash:{},data:a,loc:{start:{line:6,column:37},end:{line:6,column:55}}}):o)+"px;"},9:function(n,e,l,t,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"height:"+n.escapeExpression("function"==typeof(o=null!=(o=r(l,"containerHeight")||(null!=e?r(e,"containerHeight"):e))?o:n.hooks.helperMissing)?o.call(null!=e?e:n.nullContext||{},{name:"containerHeight",hash:{},data:a,loc:{start:{line:7,column:39},end:{line:7,column:58}}}):o)+"px;"},11:function(n,e,l,t,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"min-height:"+n.escapeExpression("function"==typeof(o=null!=(o=r(l,"containerMinHeight")||(null!=e?r(e,"containerMinHeight"):e))?o:n.hooks.helperMissing)?o.call(null!=e?e:n.nullContext||{},{name:"containerMinHeight",hash:{},data:a,loc:{start:{line:8,column:46},end:{line:8,column:68}}}):o)+"px;"},13:function(n,e,l,t,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"max-width:"+n.escapeExpression("function"==typeof(o=null!=(o=r(l,"containerMaxWidth")||(null!=e?r(e,"containerMaxWidth"):e))?o:n.hooks.helperMissing)?o.call(null!=e?e:n.nullContext||{},{name:"containerMaxWidth",hash:{},data:a,loc:{start:{line:9,column:44},end:{line:9,column:65}}}):o)+"px;"},15:function(n,e,l,t,a){var o,r,i=null!=e?e:n.nullContext||{},s=n.hooks.helperMissing,c="function",u=n.escapeExpression,p=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t<a class="nsfw-overlay-bg'+(null!=(o=(p(l,"isFlipped")||e&&p(e,"isFlipped")||s).call(i,"enable-nsfw-2024",{name:"isFlipped",hash:{},fn:n.program(16,a,0),inverse:n.noop,data:a,loc:{start:{line:12,column:27},end:{line:12,column:99}}}))?o:"")+'" href="'+u(typeof(r=null!=(r=p(l,"photoUrl")||(null!=e?p(e,"photoUrl"):e))?r:s)===c?r.call(i,{name:"photoUrl",hash:{},data:a,loc:{start:{line:12,column:107},end:{line:12,column:119}}}):r)+'" data-photo-id="'+u(typeof(r=null!=(r=p(l,"photoId")||(null!=e?p(e,"photoId"):e))?r:s)===c?r.call(i,{name:"photoId",hash:{},data:a,loc:{start:{line:12,column:136},end:{line:12,column:147}}}):r)+'"></a>\n'},16:function(n,e,l,t,a){return" photo-thumb-interstitial"},18:function(n,e,l,t,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t<span class="nsfw-overlay-bg photo-thumb-interstitial" data-photo-id="'+n.escapeExpression("function"==typeof(o=null!=(o=r(l,"photoId")||(null!=e?r(e,"photoId"):e))?o:n.hooks.helperMissing)?o.call(null!=e?e:n.nullContext||{},{name:"photoId",hash:{},data:a,loc:{start:{line:15,column:72},end:{line:15,column:83}}}):o)+'"></span>\n'},20:function(n,e,l,t,a){return" clickable"},22:function(n,e,l,t,a){return'\t\t\t<svg class="icon icon-warning warning-icon"><use xlink:href="#icon-warning"></use></svg>\n'},24:function(n,e,l,t,a){var o=null!=e?e:n.nullContext||{},r=n.hooks.helperMissing,i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t\t<p class="message">'+n.escapeExpression((i(l,"renderTrustedMarkup")||e&&i(e,"renderTrustedMarkup")||r).call(o,(i(l,"preventOrphansHtml")||e&&i(e,"preventOrphansHtml")||r).call(o,null!=e?i(e,"detailsMessage"):e,{name:"preventOrphansHtml",hash:{},data:a,loc:{start:{line:28,column:44},end:{line:28,column:79}}}),{name:"renderTrustedMarkup",hash:{},data:a,loc:{start:{line:28,column:22},end:{line:28,column:81}}}))+"</p>\n"},26:function(n,e,l,t,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t\t<button class="cta">'+n.escapeExpression("function"==typeof(o=null!=(o=r(l,"ctaMessage")||(null!=e?r(e,"ctaMessage"):e))?o:n.hooks.helperMissing)?o.call(null!=e?e:n.nullContext||{},{name:"ctaMessage",hash:{},data:a,loc:{start:{line:32,column:23},end:{line:32,column:37}}}):o)+"</button>\n"},28:function(n,e,l,t,a){var o=null!=e?e:n.nullContext||{},r=n.hooks.helperMissing,i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t\t<p class="message bottom-message">'+n.escapeExpression((i(l,"renderTrustedMarkup")||e&&i(e,"renderTrustedMarkup")||r).call(o,(i(l,"preventOrphansHtml")||e&&i(e,"preventOrphansHtml")||r).call(o,null!=e?i(e,"bottomMessage"):e,{name:"preventOrphansHtml",hash:{},data:a,loc:{start:{line:36,column:59},end:{line:36,column:93}}}),{name:"renderTrustedMarkup",hash:{},data:a,loc:{start:{line:36,column:37},end:{line:36,column:95}}}))+"</p>\n"},compiler:[8,">= 4.3.0"],main:function(n,e,l,t,a){var o,r=null!=e?e:n.nullContext||{},i=n.hooks.helperMissing,s=n.escapeExpression,c=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div class="adult-content-photo-overlay\n\t'+(null!=(o=c(l,"if").call(r,null!=e?c(e,"isCompact"):e,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:1},end:{line:2,column:33}}}))?o:"")+"\n\t"+(null!=(o=c(l,"if").call(r,null!=e?c(e,"isLarge"):e,{name:"if",hash:{},fn:n.program(3,a,0),inverse:n.noop,data:a,loc:{start:{line:3,column:1},end:{line:3,column:29}}}))?o:"")+"\n\t"+(null!=(o=(c(l,"isFlipped")||e&&c(e,"isFlipped")||i).call(r,"enable-nsfw-2024",{name:"isFlipped",hash:{},fn:n.program(5,a,0),inverse:n.noop,data:a,loc:{start:{line:4,column:1},end:{line:4,column:63}}}))?o:"")+'"\n\tstyle="\n\t\t'+(null!=(o=(c(l,"ifDefined")||e&&c(e,"ifDefined")||i).call(r,null!=e?c(e,"containerWidth"):e,{name:"ifDefined",hash:{},fn:n.program(7,a,0),inverse:n.noop,data:a,loc:{start:{line:6,column:2},end:{line:6,column:72}}}))?o:"")+"\n\t\t"+(null!=(o=(c(l,"ifDefined")||e&&c(e,"ifDefined")||i).call(r,null!=e?c(e,"containerHeight"):e,{name:"ifDefined",hash:{},fn:n.program(9,a,0),inverse:n.noop,data:a,loc:{start:{line:7,column:2},end:{line:7,column:75}}}))?o:"")+"\n\t\t"+(null!=(o=(c(l,"ifDefined")||e&&c(e,"ifDefined")||i).call(r,null!=e?c(e,"containerMinHeight"):e,{name:"ifDefined",hash:{},fn:n.program(11,a,0),inverse:n.noop,data:a,loc:{start:{line:8,column:2},end:{line:8,column:85}}}))?o:"")+"\n\t\t"+(null!=(o=(c(l,"ifDefined")||e&&c(e,"ifDefined")||i).call(r,null!=e?c(e,"containerMaxWidth"):e,{name:"ifDefined",hash:{},fn:n.program(13,a,0),inverse:n.noop,data:a,loc:{start:{line:9,column:2},end:{line:9,column:82}}}))?o:"")+'\n\t\t">\n'+(null!=(o=c(l,"if").call(r,null!=e?c(e,"photoUrl"):e,{name:"if",hash:{},fn:n.program(15,a,0),inverse:n.program(18,a,0),data:a,loc:{start:{line:11,column:1},end:{line:16,column:8}}}))?o:"")+'\t<div class="content-container'+(null!=(o=c(l,"if").call(r,null!=e?c(e,"ctaMessage"):e,{name:"if",hash:{},fn:n.program(20,a,0),inverse:n.noop,data:a,loc:{start:{line:17,column:30},end:{line:17,column:65}}}))?o:"")+'">\n\n'+(null!=(o=c(l,"if").call(r,null!=e?c(e,"showIcon"):e,{name:"if",hash:{},fn:n.program(22,a,0),inverse:n.noop,data:a,loc:{start:{line:19,column:2},end:{line:21,column:9}}}))?o:"")+'\n\t\t<div class="eighteen-plus">18+</div>\n\n\t\t<h1 class="nsfw-overlay-title">'+s((c(l,"intlMessage")||e&&c(e,"intlMessage")||i).call(r,{name:"intlMessage",hash:{intlName:"adult-content-overlay.ADULT_CONTENT"},data:a,loc:{start:{line:25,column:33},end:{line:25,column:95}}}))+'</h1>\n\t\t<p class="message main-message">'+s((c(l,"preventOrphans")||e&&c(e,"preventOrphans")||i).call(r,(c(l,"intlMessage")||e&&c(e,"intlMessage")||i).call(r,{name:"intlMessage",hash:{intlName:"adult-content-overlay.MATURE_AUDIENCES"},data:a,loc:{start:{line:26,column:51},end:{line:26,column:114}}}),{name:"preventOrphans",hash:{},data:a,loc:{start:{line:26,column:34},end:{line:26,column:116}}}))+"</p>\n"+(null!=(o=c(l,"if").call(r,null!=e?c(e,"detailsMessage"):e,{name:"if",hash:{},fn:n.program(24,a,0),inverse:n.noop,data:a,loc:{start:{line:27,column:2},end:{line:29,column:9}}}))?o:"")+"\n"+(null!=(o=c(l,"if").call(r,null!=e?c(e,"ctaMessage"):e,{name:"if",hash:{},fn:n.program(26,a,0),inverse:n.noop,data:a,loc:{start:{line:31,column:2},end:{line:33,column:9}}}))?o:"")+"\n"+(null!=(o=c(l,"if").call(r,null!=e?c(e,"bottomMessage"):e,{name:"if",hash:{},fn:n.program(28,a,0),inverse:n.noop,data:a,loc:{start:{line:35,column:2},end:{line:37,column:9}}}))?o:"")+"\t</div>\n</div>\n"},useData:!0}),t={};n.Array.each([],(function(e){var l=n.Template.get("hermes/"+e);l&&(t[e]=l)})),n.Template.register("hermes/adult-content-photo-overlay",(function(e,a){return(a=a||{}).partials=a.partials?n.merge(t,a.partials):t,l(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-list-layout-row",(function(t){(t.PhotoListLayoutRow=function(t){this.top=t.top,this.left=t.left,this.width=t.width,this.spacing=t.spacing,this.targetRowHeight=t.targetRowHeight,this.targetRowHeightTolerance=t.targetRowHeightTolerance,this.additionalHeight=t.additionalHeight||0,this.minAspectRatio=this.width/t.targetRowHeight*(1-t.targetRowHeightTolerance),this.maxAspectRatio=this.width/t.targetRowHeight*(1+t.targetRowHeightTolerance),this.edgeCaseMinRowHeight=t.edgeCaseMinRowHeight||Number.NEGATIVE_INFINITY,this.edgeCaseMaxRowHeight=t.edgeCaseMaxRowHeight||Number.POSITIVE_INFINITY,this.rightToLeft=t.rightToLeft,this.isBreakoutRow=t.isBreakoutRow,this.staticViewsConfig=t.staticViewsConfig,this.items=[],this.height=0}).prototype={addItem:function(i){var e,h,s,o=this.items.concat(i),a=this.width-(o.length-1)*this.spacing,g=o.reduce((function(t,i){return t+i.aspectRatio}),0),n=a/this.targetRowHeight;return i.isStaticItem&&this.staticViewsConfig&&this.staticViewsConfig.isFullRow?0===this.items.length&&(this.items.push(t.merge(i)),this._completeLayout(i.fullRowMinHeight||this.targetRowHeight),!0):(this.isBreakoutRow||this.isStaticItem&&!this.staticViewsConfig.isFullRow)&&0===this.items.length&&i.aspectRatio>=1?(this.items.push(t.merge(i)),this._completeLayout(a/i.aspectRatio),!0):0!==g&&(g<this.minAspectRatio?(this.items.push(t.merge(i)),!0):g>this.maxAspectRatio?i.isStaticItem||0===this.items.length?(this.items.push(t.merge(i)),this._completeLayout(a/g),!0):(e=this.width-(this.items.length-1)*this.spacing,h=this.items.reduce((function(t,i){return t+i.aspectRatio}),0),s=e/this.targetRowHeight,Math.abs(g-n)>Math.abs(h-s)?(this._completeLayout(e/h),!1):(this.items.push(t.merge(i)),this._completeLayout(a/g),!0)):(this.items.push(t.merge(i)),this._completeLayout(a/g),!0))},forceComplete:function(t,i){var e=this.width-(this.items.length-1)*this.spacing,h=this.items.reduce((function(t,i){return t+i.aspectRatio}),0);"number"==typeof i?this._completeLayout(i-this.additionalHeight,!1):t?this._completeLayout(e/h):this._completeLayout(this.targetRowHeight-this.additionalHeight,!1)},isLayoutComplete:function(){return this.height>0},getItems:function(){return this.rightToLeft?this.items.reverse():this.items},getIndexOfItem:function(t){var i=-1;return this.items.some((function(e,h){if(e.id===t)return i=h,!0})),i},setTop:function(t){this.top=t,this.items.forEach((function(i){i.geometry.top=t}))},_completeLayout:function(t,i){var e,h,s,o,a,g,n=this.rightToLeft?-this.left:this.left,r=this.width-(this.items.length-1)*this.spacing,m=this;void 0===i&&(i=!0),(h=Math.round(t))!==(s=Math.max(this.edgeCaseMinRowHeight,Math.min(h,this.edgeCaseMaxRowHeight)))?(this.height=s,e=r/s/(r/h)):(this.height=h,e=1),this.items.forEach((function(t,i){t.geometry={top:m.top,width:Math.round(t.aspectRatio*m.height*e),height:m.height+m.additionalHeight},m.rightToLeft?t.geometry.left=m.width-n-t.geometry.width:t.geometry.left=n,n+=t.geometry.width+m.spacing})),this.height+=m.additionalHeight,i&&(this.rightToLeft||(n-=this.spacing+this.left),o=(n-this.width)/this.items.length,a=this.items.map((function(t,i){return Math.round((i+1)*o)})),1===this.items.length?((g=this.items[0].geometry).width-=Math.round(o),this.rightToLeft&&(g.left+=Math.round(o))):this.items.forEach((function(t,i){i>0?(t.geometry.left-=a[i-1],t.geometry.width-=a[i]-a[i-1]):t.geometry.width-=a[i]})))}}}),"@VERSION@",{requires:[]});YUI.add("photo-list-layout",(function(t,e){var i=require("hermes-core/flog")(e),a={containerPadding:{top:8,right:8,bottom:8,left:8},itemSpacing:{horizontal:8,vertical:8},targetRowHeight:320,targetRowHeightTolerance:.25,awakeBoundsToViewportSizeRatio:3,maxNumRows:Number.POSITIVE_INFINITY,forceAspectRatio:Number.NaN,alwaysDisplayOrphans:!1,sleepTopAndBottom:!0,sleepLeftAndRight:!1,fullWidthBreakoutRowCadence:!1,deferWakeSleepUntil:2500,staticViewsConfig:{includeStaticViews:!1,isFullRow:!1,fullRowMinHeight:0,cadence:0,dynamicCadence:!1,staticViewsQueueLength:Number.POSITIVE_INFINITY,staticViewsName:""}};(t.PhotoListLayout=function(e){if(!e.appContext)throw new Error("PhotoListLayout must be instantiated with `params.appContext`.");e=t.merge(a,e),this.appContext=e.appContext,this.containerWidth=e.containerWidth,this.viewportContainerNodeHeight=e.viewportContainerNodeHeight||this.appContext.viewportData.getHeight(),this.containerPadding=e.containerPadding,this.itemSpacing=e.itemSpacing,this.targetRowHeight=e.targetRowHeight,this.targetRowHeightTolerance=e.targetRowHeightTolerance,this.awakeBoundsToViewportSizeRatio=e.awakeBoundsToViewportSizeRatio,this.maxNumRows=e.maxNumRows,this.forceAspectRatio=e.forceAspectRatio,this.alwaysDisplayOrphans=e.alwaysDisplayOrphans,this.sleepTopAndBottom=e.sleepTopAndBottom,this.sleepLeftAndRight=e.sleepLeftAndRight,this.fullWidthBreakoutRowCadence=e.fullWidthBreakoutRowCadence,this.deferWakeSleepUntil=e.deferWakeSleepUntil,this.additionalHeight=e.additionalHeight||0,this.staticViewsConfig=e.staticViewsConfig,this.staticViewsQueueLength=e.staticViewsConfig.staticViewsQueueLength,this.staticViewsCadence=e.staticViewsConfig.cadence,this.hasDynamicCadence=e.staticViewsConfig.dynamicCadence,this.defaultDynamicCadenceInitial=4,this.staticViewsLaidOut=0,this._layoutItems=[],this._awakeItems=[],this._inViewportItems=[],this._leadingOrphans=[],this._trailingOrphans=[],this._containerHeight=this.containerPadding.top,this._rows=[],this._orphans=[],!this.staticViewsCadence&&this.hasDynamicCadence&&(this.staticViewsCadence=this.defaultDynamicCadenceInitial)}).prototype={getCurrentLayout:function(){return this._layoutItems.concat()},getAwakeItems:function(){return this._awakeItems.concat()},getInViewportItems:function(){return this._inViewportItems.concat()},hasLimitedNumberOfRows:function(){return this.maxNumRows!==a.maxNumRows},getLayoutItem:function(t,e){var i=null;return(e||this._layoutItems).some((function(e){if(e.id===t)return i=e,!0})),i},getItemsInRow:function(t){return this._rows.length<=t?[]:this._rows[t].items.concat()},isMobile:function(e){let i=0;return e&&(i=YUI.Env.isServer?this.appContext.viewportData.getScrollbarWidth():t.OverflowHelper.detectScrollbarSize(t.one("body"))),this.appContext.viewportData.getWidth()+i<=700},invalidateItem:function(t){var e,i=function(i,a,s){if(i.id===t)return s.splice(a,1),e=!0,!0};return this._layoutItems.some(i),this._leadingOrphans.some(i),this._trailingOrphans.some(i),this._rows.some((function(t){return t.items.some(i)})),this._orphans.some(i),e},clear:function(){this._layoutItems=[],this._leadingOrphans=[],this._trailingOrphans=[],this._containerHeight=this.containerPadding.top,this._rows=[],this._orphans=[],this.staticViewsLaidOut=0},updateTargetRowHeight:function(t){this.targetRowHeight=t,this.updatedRowHeight=this.targetRowHeight},computeLayout:function(t,e,a,s,o){var n,h,r,l,c,u,w,g,d,m={},p=[],f=[],I=[],_=!1,R=this;switch(this.containerWidth||(i.log("No valid containerWidth set on photo-list-layout; falling back to default"),this.containerWidth=1060),t||(t=[]),this.forceAspectRatio&&t.forEach((function(t){t.forcedAspectRatio=!0,t.aspectRatio=R.forceAspectRatio})),n=this._layoutItems.concat(),this._layoutItems.forEach((function(t){m[t.id]=t})),s||(s={diffType:"append"}),s.diffType){case"prepend":t=t.concat(this._leadingOrphans),this._leadingOrphans=[],t.reverse(),_=!0;break;case"relayout":s.diffDirection?"top"===s.diffDirection?t=t.concat(this._leadingOrphans.concat(this._layoutItems.concat(this._trailingOrphans))):"bottom"===s.diffDirection&&(t=this._leadingOrphans.concat(this._layoutItems.concat(this._trailingOrphans)).concat(t)):t=this._leadingOrphans.concat(this._layoutItems.concat(this._trailingOrphans)),this.clear();break;default:t=this._trailingOrphans.concat(t),this._trailingOrphans=[],this._rows.length>1&&(this._containerHeight=this._containerHeight-this.containerPadding.bottom+this.itemSpacing.vertical)}return t.some((function(e,a){if(l=!1,h||(h=R.createNewRow(_)),[t,e]=R.recalcFullStaticRowPosition(t,e,a,h),e&&R.shouldSkipFullRowItem(e)?(r=!0,R._layoutItems=R._layoutItems.concat(e)):r=h.addItem(e),h.isLayoutComplete()){if(p=p.concat(R.addRow(h,_)),"relayout"!==s.diffType&&R.staticViewsConfig.includeStaticViews&&R.staticViewsConfig.isFullRow&&R.staticViewsQueueLength>0&&R.isWithinFullRowCadence()&&!R.isMobile(!0)&&!R.getLayoutItem("static-full-item-"+a+o,t)?(h=R.createNewRow(_,!0),r=h.addItem({id:"static-full-item-"+a+o,isStaticItem:!0,fullRowStatic:!0,fullRowMinHeight:R.staticViewsConfig.fullRowMinHeight||0,aspectRatio:1,width:500,height:R.staticViewsConfig.fullRowMinHeight||0,name:R.staticViewsConfig.staticViewsName,siblingPosition:R.staticViewsLaidOut,staticRowIndex:R.staticViewsLaidOut}),"photo-list-revenue-item-view"===R.staticViewsConfig.staticViewsName&&(h.edgeCaseMaxRowHeight=350),h.forceComplete(!0),p=p.concat(R.addRow(h,_)),R.staticViewsQueueLength--,R.staticViewsLaidOut++):e.fullRowStatic&&e.isStaticItem&&R.staticViewsLaidOut++,R._rows.length>=R.maxNumRows)return h=null,!0;if(h=R.createNewRow(_),!r)if(r=h.addItem(e),h.isLayoutComplete()){if(p=p.concat(R.addRow(h,_)),R._rows.length>=R.maxNumRows)return h=null,!0;h=R.createNewRow(_)}else r||(l=!0)}else if(!r){let i=[],s=R._rows&&R._rows.length?R.getItemsInRow(R._rows.length-1):null;if(e.isStaticItem&&e.fullRowStatic){if(R.isWithinFullRowCadence()&&s&&!s[0].isStaticItem){if(h.items.forEach(((t,e)=>{i.push(t)})),h=null,(h=R.createNewRow(_,!0)).addItem(e),p=p.concat(R.addRow(h,_)),R.staticViewsLaidOut++,h=R.createNewRow(_),R._rows.length>=R.maxNumRows)return h=null,!0;i.forEach(((t,e)=>{h.addItem(t)}))}else if(t[a+1]){let i=e;for(let s=a+1;s<t.length;s++)if(!t[s].isStaticItem&&!t[s].fullRowStatic){e=t[s],t[a]=t[s],t[s]=i;break}if(r=h.addItem(t[a]),h.isLayoutComplete()){if(p=p.concat(R.addRow(h,_)),R._rows.length>=R.maxNumRows)return h=null,!0;h=R.createNewRow(_)}else r||(l=!0)}}else l=!0}l&&i.warn("computeLayout() Item not added and layout not complete",e)})),this._rows.length>=this.maxNumRows?(this._layoutItems||(i.warn("computeLayout() LayoutItems are unexpectedly undefined"),this._layoutItems=[]),this._trailingOrphans=t.slice(this._layoutItems.length)):h&&h.getItems().length&&(_?s.firstPage?(h.forceComplete(!0),p=p.concat(R.addRow(h,_))):this._leadingOrphans=h.getItems().reverse():s.lastPage||this.alwaysDisplayOrphans?(this._rows.length?(d=this._rows[this._rows.length-1].isBreakoutRow?this._rows[this._rows.length-1].targetRowHeight:this._rows[this._rows.length-1].height,h.forceComplete(!1,this.updatedRowHeight||d)):this.alwaysDisplayOrphans&&n.length?n[n.length-1].geometry&&h.forceComplete(!1,this.updatedRowHeight||n[n.length-1].geometry.height):h.forceComplete(!1),p=p.concat(R.addRow(h,_)),delete this.updatedRowHeight):this._trailingOrphans=h.getItems().concat()),p.forEach((function(t){m[t.id]?I.push(t):f.push(t)})),this._containerHeight=this._containerHeight-this.itemSpacing.vertical+this.containerPadding.bottom,_&&(g=this.containerPadding.top,this._rows.forEach((function(t){t.setTop(g),g+=t.height+R.itemSpacing.vertical})),I=n.concat()),w=this.computeWakeSleep(e,a,m),c=w.wakeSleepChangedItems,u=w.inViewportChangedItems,this._trailingOrphans.concat(this._leadingOrphans).forEach((function(t){m[t.id]&&(t.isAwake=!1,c.push(t))})),{allLayoutItems:this._layoutItems.concat(),newItems:f,layoutChangedItems:I,wakeSleepChangedItems:c,inViewportChangedItems:u,leadingOrphans:this._leadingOrphans.concat(),trailingOrphans:this._trailingOrphans.concat(),containerHeight:this._containerHeight}},recalcFullStaticRowPosition:function(t,e,i,a){let s,o,n=this,h=i,r=e,l=!1;return n._rows&&n._rows.length&&0===n.staticViewsQueueLength&&n.staticViewsConfig.staticViewsQueueLength>n.staticViewsLaidOut&&(n.isWithinFullRowCadence()?e.fullRowStatic?n.getItemsInRow(n._rows.length-1)[0].isStaticItem&&(l=!0,s="regularItem"):n.getItemsInRow(n._rows.length-1)[0].isStaticItem||(l=!0,s="fullRow"):e.fullRowStatic&&(l=!0,s="regularItem")),l&&(o=n.findTypeItemInLayout(s,t,h),o&&(e=t[o],t[h]=t[o],t[o]=r)),[t,e]},findTypeItemInLayout:function(t,e,i){let a=t;if(!e[i+1])return null;for(let t=i+1;t<e.length;t++)if("fullRow"===a){if(e[t].isStaticItem&&e[t].fullRowStatic)return t}else if("regularItem"===a&&!e[t].isStaticItem)return t},setDynamicCadence:function(){let t,e=[],i=this.defaultDynamicCadenceInitial;for(let t=0;t<2;t++){let a=[];for(let e=0;e<3;e++)0===e&&0===t?a.push(i):a.push(i+1),i=a[e];e.push(a)}t=Math.floor(Math.random()*e.length),this.staticViewsCadence+=e[t][Math.floor(Math.random()*e[t].length)]},isWithinFullRowCadence:function(){let t=this,e=0,i=!1,a=!1;return!!t.staticViewsCadence&&(t._rows&&(e=t._rows.length,i=t.staticViewsLaidOut,i?(e-t.staticViewsLaidOut)%t.staticViewsCadence==0&&(a=!0):e%t.staticViewsCadence==0&&(a=!0)),a&&t.hasDynamicCadence&&t.setDynamicCadence(),a)},shouldSkipFullRowItem:function(t){let e=!1;return t.name&&"photo-list-revenue-item-view"===t.name&&this.isMobile(!0)&&(e=!0),e},computeWakeSleep:function(t,e,a){var s=this._awakeItems=[],o=this._inViewportItems=[];t||(t=0),e||(e=0),this.viewportContainerNodeHeight||(i.log("No valid viewport height available for photo-list-layout; falling back to default"),this.viewportContainerNodeHeight=1e3);var n,h,r,l,c,u=this.viewportContainerNodeHeight,w=.5*u*(this.awakeBoundsToViewportSizeRatio-1),g=t,d=t+u,m=g-w,p=d+w,f=[],I=[],_=this._layoutItems.length<this.deferWakeSleepUntil,R=this;return this.sleepLeftAndRight&&(h=.5*(n=this.appContext.viewportData.getWidth())*(this.awakeBoundsToViewportSizeRatio-1),r=e-h,l=e+n+h),this._layoutItems.forEach((function(t){a&&(c=a[t.id]),_?t.isAwake=!0:(R.sleepTopAndBottom?t.isAwake=t.geometry.top+t.geometry.height>=m&&t.geometry.top<p:t.isAwake=!0,t.isAwake&&R.sleepLeftAndRight&&(t.isAwake=t.geometry.left+t.geometry.width>=r&&t.geometry.left<l)),c&&c.isAwake===t.isAwake||f.push(t),t.isAwake&&s.push(t),t.isInViewport=t.geometry.top+t.geometry.height>=g&&t.geometry.top<d,I.push(t),t.isInViewport&&o.push(t)})),{allLayoutItems:a?this._layoutItems:this._layoutItems.concat(),newItems:[],layoutChangedItems:[],wakeSleepChangedItems:f,inViewportChangedItems:I,leadingOrphans:this._leadingOrphans.concat(),trailingOrphans:this._trailingOrphans.concat(),containerHeight:this._containerHeight}},updateLayoutFrom:function(t,e){var i,a,s,o;this._layoutItems.length&&this._layoutItems.length>e&&(i=this._layoutItems[e],(a=this.getRowOfItem(i.id))&&(this._rows=this._rows.slice(0,a.index),s=this._rows[this._rows.length-1],this._containerHeight=s?s.top+s.height:0,a.indexInRow>0&&(o=(o=this._layoutItems.splice(-a.indexInRow)).map((function(t){return{id:t.id,aspectRatio:t.aspectRatio,layoutType:t.layoutType}})),t.unshift.apply(t,o))),this._layoutItems=this._layoutItems.slice(0,Math.min(this._layoutItems.length,e)))},createNewRow:function(e,i){let a=!1;return(i||!1!==this.fullWidthBreakoutRowCadence)&&(this._rows.length+1)%this.fullWidthBreakoutRowCadence==0&&(a=!0),new t.PhotoListLayoutRow({top:this._containerHeight,left:this.containerPadding.left,width:this.containerWidth-this.containerPadding.left-this.containerPadding.right,spacing:this.itemSpacing.horizontal,targetRowHeight:this.targetRowHeight,targetRowHeightTolerance:this.targetRowHeightTolerance,edgeCaseMinRowHeight:.5*this.targetRowHeight,edgeCaseMaxRowHeight:2*this.targetRowHeight,rightToLeft:e,isBreakoutRow:a,additionalHeight:this.additionalHeight,staticViewsConfig:this.staticViewsConfig})},addRow:function(t,e){return e?(this._rows.unshift(t),this._layoutItems=t.getItems().reverse().concat(this._layoutItems)):(this._rows.push(t),this._layoutItems=this._layoutItems.concat(t.getItems())),this._containerHeight+=t.height+this.itemSpacing.vertical,t.items},getRowOfItem:function(t){var e,i,a;for(i=0;i<this._rows.length;i++)if(-1!==(a=(e=this._rows[i]).getIndexOfItem(t)))return{row:e,index:i,indexInRow:a};return null}}}),"@VERSION@",{requires:["photo-list-layout-row","overflow-helper"],optionalRequires:["hermes-core"]});YUI.add("hermes-template-photo-card-overlay-icon",(function(n,e){var o=n.Template.Handlebars.revive({1:function(n,e,o,l,a){return"\t\tautoplay\n"},3:function(n,e,o,l,a){return"\t\tvideo\n"},5:function(n,e,o,l,a){return"\t\tplay\n\t"},7:function(n,e,o,l,a){return'\t\t<svg class="icon icon-autoplay"><use xlink:href="#icon-autoplay"></use></svg>\n'},9:function(n,e,o,l,a){return'\t\t<svg class="icon icon-video"><use xlink:href="#icon-video"></use></svg>\n'},11:function(n,e,o,l,a){return'\t\t<svg class="icon icon-play"><use xlink:href="#icon-play"></use></svg>\n'},compiler:[8,">= 4.3.0"],main:function(n,e,o,l,a){var t,i=null!=e?e:n.nullContext||{},r=n.hooks.helperMissing,u=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div class="photo-card-overlay-icon\n'+(null!=(t=(u(o,"ifCond")||e&&u(e,"ifCond")||r).call(i,null!=e?u(e,"type"):e,"===","autoplay",{name:"ifCond",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:1},end:{line:4,column:12}}}))?t:"")+(null!=(t=(u(o,"ifCond")||e&&u(e,"ifCond")||r).call(i,null!=e?u(e,"type"):e,"===","video",{name:"ifCond",hash:{},fn:n.program(3,a,0),inverse:n.noop,data:a,loc:{start:{line:5,column:1},end:{line:7,column:12}}}))?t:"")+(null!=(t=(u(o,"ifCond")||e&&u(e,"ifCond")||r).call(i,null!=e?u(e,"type"):e,"===","play",{name:"ifCond",hash:{},fn:n.program(5,a,0),inverse:n.noop,data:a,loc:{start:{line:8,column:1},end:{line:10,column:12}}}))?t:"")+'">\n\n'+(null!=(t=(u(o,"ifCond")||e&&u(e,"ifCond")||r).call(i,null!=e?u(e,"type"):e,"===","autoplay",{name:"ifCond",hash:{},fn:n.program(7,a,0),inverse:n.noop,data:a,loc:{start:{line:12,column:1},end:{line:14,column:12}}}))?t:"")+"\n"+(null!=(t=(u(o,"ifCond")||e&&u(e,"ifCond")||r).call(i,null!=e?u(e,"type"):e,"===","video",{name:"ifCond",hash:{},fn:n.program(9,a,0),inverse:n.noop,data:a,loc:{start:{line:16,column:1},end:{line:18,column:12}}}))?t:"")+"\n"+(null!=(t=(u(o,"ifCond")||e&&u(e,"ifCond")||r).call(i,null!=e?u(e,"type"):e,"===","play",{name:"ifCond",hash:{},fn:n.program(11,a,0),inverse:n.noop,data:a,loc:{start:{line:20,column:1},end:{line:22,column:12}}}))?t:"")+"\n</div>"},useData:!0}),l={};n.Array.each([],(function(e){var o=n.Template.get("hermes/"+e);o&&(l[e]=o)})),n.Template.register("hermes/photo-card-overlay-icon",(function(e,a){return(a=a||{}).partials=a.partials?n.merge(l,a.partials):l,o(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});