YUI.add("hermes-template-photostream-filter-tools",(function(e,a){var l=e.Template.Handlebars.revive({1:function(e,a,l,n,t){var r,o=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<div class="dropdown-link filter-view" aria-haspopup="true" aria-expanded="false" tabindex="0"><p>'+e.escapeExpression("function"==typeof(r=null!=(r=o(l,"filterValue")||(null!=a?o(a,"filterValue"):a))?r:e.hooks.helperMissing)?r.call(null!=a?a:e.nullContext||{},{name:"filterValue",hash:{},data:t,loc:{start:{line:3,column:98},end:{line:3,column:113}}}):r)+"</p><span></span></div>\n"},compiler:[8,">= 4.3.0"],main:function(e,a,l,n,t){var r,o,i=null!=a?a:e.nullContext||{},s=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<div class="dropdown-link filter-sort" aria-haspopup="true" aria-expanded="false" tabindex="0"><p>'+e.escapeExpression("function"==typeof(o=null!=(o=s(l,"sortValue")||(null!=a?s(a,"sortValue"):a))?o:e.hooks.helperMissing)?o.call(i,{name:"sortValue",hash:{},data:t,loc:{start:{line:1,column:98},end:{line:1,column:111}}}):o)+"</p><span></span></div>\n"+(null!=(r=s(l,"if").call(i,null!=a?s(a,"viewingSelf"):a,{name:"if",hash:{},fn:e.program(1,t,0),inverse:e.noop,data:t,loc:{start:{line:2,column:0},end:{line:4,column:7}}}))?r:"")},useData:!0}),n={};e.Array.each([],(function(a){var l=e.Template.get("hermes/"+a);l&&(n[a]=l)})),e.Template.register("hermes/photostream-filter-tools",(function(a,t){return(t=t||{}).partials=t.partials?e.merge(n,t.partials):n,l(a,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photostream-filter-tools-view",(function(e){var t={filterView:".filter-view",filterSort:".filter-sort",help:".filter-helper .filter-helper-icon"},r={me:"filter-bar.VIEW_ALL",fr:"filter-bar.FRIEND",fa:"filter-bar.FAMILY",ff:"filter-bar.FRIEND_AND_FAMILY",pu:"filter-bar.PUBLIC",dt:"cameraroll.DATE_TAKEN",dc:"cameraroll.DATE_UPLOADED"};e.namespace("Views")[this.name]=e.Base.create("photostream-filter-tools-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.set("viewingSelf",this.appContext.getViewer().nsid===this.nsid),this},loadState:function(){var t=this,r=[];return this.appContext.getViewer().signedIn&&r.push(this.appContext.getModel("person-preferences-models",this.appContext.getViewer().nsid).then((function(r){t.set("personPreferenceModel",r),t.set("filterValue",e.Models["person-preferences-models"].getReadablePrefName(r.getValue("photostreamViewAsPref"))),t.set("sortValue",e.Models["person-preferences-models"].getReadablePrefName(r.getValue("photostreamViewOrderPref")))}))),e.Promise.all(r)},buildContainer:function(){var e=this.get("personPreferenceModel");return this.setContainerWithTemplate("photostream-filter-tools",{viewingSelf:this.get("viewingSelf"),sortValue:this.intlMessage({intlName:r[e.getValue("photostreamViewOrderPref")]}),filterValue:this.intlMessage({intlName:r[e.getValue("photostreamViewAsPref")]})}),this},activate:function(){return this.get("viewingSelf")&&(this.registerEventHandler(this.get("container").one(t.filterView).on("click",this.handleFilterView,this)),e.Accessibility.makeDroparoundAnchorAccessible({view:this,getDroparound:this.getDroparound.bind(this),anchor:this.get("container").one(".filter-view"),handler:this.handleFilterView.bind(this)})),this.registerEventHandler(this.get("container").one(t.filterSort).on("click",this.handleFilterSort,this)),e.Accessibility.makeDroparoundAnchorAccessible({view:this,getDroparound:this.getDroparound.bind(this),anchor:this.get("container").one(".filter-sort"),handler:this.handleFilterSort.bind(this)}),this},getDroparound:function(){return this.dropdown},handleFilterSort:function(t){t.halt();var r=this;this.dropdown=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:t.target.one("span"),keyboardAnchorElement:t.target,minVerticalSpace:400,positionFixed:!0,preferLeft:!0,closeOnScroll:!0,menuItems:[{text:this.intlMessage({intlName:"cameraroll.DATE_UPLOADED"}),data:"dateposted"},{text:this.intlMessage({intlName:"cameraroll.DATE_TAKEN"}),data:"datetaken"}]}),this.dropdown.show(),this.registerEventHandler(this.dropdown.on("selected",(function(e){e&&e.menuItem&&(r.get("container").one(".filter-sort p").set("text",e.menuItem.text),r.set("sortValue",e.menuItem.data),r.notifyPhotostreamToUpdate()),r.dropdown.close()})),this)},handleFilterView:function(t){t.halt();var r=this;this.dropdown=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:t.target.one("span"),keyboardAnchorElement:t.target,minVerticalSpace:400,preferLeft:!0,closeOnScroll:!0,positionFixed:!0,menuItems:[{text:this.intlMessage({intlName:"filter-bar.PUBLIC"}),data:"public"},{text:this.intlMessage({intlName:"filter-bar.FRIEND"}),data:"friend"},{text:this.intlMessage({intlName:"filter-bar.FAMILY"}),data:"family"},{text:this.intlMessage({intlName:"filter-bar.FRIEND_AND_FAMILY"}),data:"ff"},{text:this.intlMessage({intlName:"filter-bar.VIEW_ALL"}),data:"me"}]}),this.dropdown.show(),this.registerEventHandler(this.dropdown.on("selected",(function(e){e&&e.menuItem&&(r.get("container").one(".filter-view p").set("text",e.menuItem.text),r.set("filterValue",e.menuItem.data),r.notifyPhotostreamToUpdate()),r.dropdown.close()})),this)},notifyPhotostreamToUpdate:function(){var t=this;this.get("personPreferenceModel").setValues({photostreamViewAsPref:e.Models["person-preferences-models"].PHOTOSTREAM_VIEW_AS_TYPES[this.get("filterValue")],photostreamViewOrderPref:e.Models["person-preferences-models"].PHOTOSTREAM_VIEW_ORDER_TYPES[this.get("sortValue")]}),e.fire("loader:start"),this.get("personPreferenceModel").remoteUpdate().then((function(){t.fire("subviewViewEvent","photostream:filter",{filterValue:t.get("filterValue"),sortValue:t.get("sortValue")})}))}},{ATTRS:{filterValue:{value:"me"},sortValue:{value:"dateposted"}}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-droparound-view","hermes-template-photostream-filter-tools"],langBundles:["cameraroll","filter-bar"]});YUI.add("hermes-template-basic-closeable-header",(function(e,l){var n=e.Template.Handlebars.revive({1:function(e,l,n,a,t){return'\t\t<a role="button" class="close-x-button">\n\t\t\t<svg class="icon icon-close"><use xlink:href="#icon-close"></use></svg>\n\t\t</a>\n'},compiler:[8,">= 4.3.0"],main:function(e,l,n,a,t){var r,s,o=null!=l?l:e.nullContext||{},i=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'<header class="basic-closeable-header">\n\t<h5>'+e.escapeExpression("function"==typeof(s=null!=(s=i(n,"title")||(null!=l?i(l,"title"):l))?s:e.hooks.helperMissing)?s.call(o,{name:"title",hash:{},data:t,loc:{start:{line:6,column:5},end:{line:6,column:14}}}):s)+"</h5>\n"+(null!=(r=i(n,"if").call(o,null!=l?i(l,"showCloseXButton"):l,{name:"if",hash:{},fn:e.program(1,t,0),inverse:e.noop,data:t,loc:{start:{line:7,column:1},end:{line:11,column:8}}}))?r:"")+"</header>\n"},useData:!0}),a={};e.Array.each([],(function(l){var n=e.Template.get("hermes/"+l);n&&(a[l]=n)})),e.Template.register("hermes/basic-closeable-header",(function(l,t){return(t=t||{}).partials=t.partials?e.merge(a,t.partials):a,n(l,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("basic-closeable-header-view",(function(e,t){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.set("isActiveViewAgnostic",!0),e.title=void 0!==e.title?e.title:"",e.showCloseXButton=void 0===e.showCloseXButton||e.showCloseXButton,this.onClose=void 0!==e.onClose?e.onClose:async e=>{},this.params=e,this},loadState:function(){return Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("basic-closeable-header",this.params),this},activate:function(){let e=this.get("container");this.closeXButton=e.one("header .close-x-button"),this.closeXButton&&this.registerEventHandler(this.closeXButton.on("click",this.handleCloseClick.bind(this)))},handleCloseClick:function(e){this.onClose(e)}})}),"@VERSION@",{requires:["flickr-view","hermes-template-basic-closeable-header"],langBundles:["common"]});YUI.add("hermes-template-photostream-filters-list",(function(e,t){var l=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,t,l,a,n){var o=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,s=e.escapeExpression,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"\n"+s((i(l,"outlet")||t&&i(t,"outlet")||r).call(o,null!=t?i(t,"basic-closeable-header-view"):t,{name:"outlet",hash:{},data:n,loc:{start:{line:2,column:0},end:{line:2,column:38}}}))+'\n\n<div class="list-container">\n\t'+s((i(l,"outlet")||t&&i(t,"outlet")||r).call(o,null!=t?i(t,"photostream-filter-tools-view"):t,{name:"outlet",hash:{},data:n,loc:{start:{line:5,column:1},end:{line:5,column:41}}}))+"\n</div>\n\n"+s((i(l,"outlet")||t&&i(t,"outlet")||r).call(o,null!=t?i(t,"basic-confirm-actions-view"):t,{name:"outlet",hash:{},data:n,loc:{start:{line:8,column:0},end:{line:8,column:37}}}))+"\n"},useData:!0}),a={};e.Array.each([],(function(t){var l=e.Template.get("hermes/"+t);l&&(a[t]=l)})),e.Template.register("hermes/photostream-filters-list",(function(t,n){return(n=n||{}).partials=n.partials?e.merge(a,n.partials):a,l(t,n)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photostream-filters-list-view",(function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.set("isActiveViewAgnostic",!0),this.nsid=e.nsid,this.filterOrSortValueUpdated=!1,this.subviewConfig["basic-closeable-header-view"]=Object.assign(this.subviewConfig["basic-closeable-header-view"],{title:this.intlMessage({intlName:"filter-bar.SORT_AND_FILTER"}),onClose:this.handleCloseClick.bind(this)}),this.subviewConfig["basic-confirm-actions-view"]=Object.assign(this.subviewConfig["basic-confirm-actions-view"],{onConfirm:this.handleConfirm.bind(this),showCancelButton:!1,confirmButtonText:this.intlMessage({intlName:"common.DONE"})}),this},subviewConfig:{"basic-closeable-header-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"photostream-filter-tools-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"basic-confirm-actions-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1}},loadState:function(){return Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("photostream-filters-list",{}),this},handleCloseClick:function(e){this.fire("readyToClose")},handleConfirm:function(e,i){this.filterOrSortValueUpdated?(i.setButtonState({confirm:"loading"}),this.appContext.flapp.navigate(window.location.href)):this.fire("readyToClose")},onSubviewEvent:function(e,i){"photostream:filter"===i[0]&&(this.filterOrSortValueUpdated=!0)}})}),"@VERSION@",{requires:["flickr-view","basic-closeable-header-view","photostream-filter-tools-view","basic-confirm-actions-view","hermes-template-photostream-filters-list"],langBundles:["common","filter-bar"]});